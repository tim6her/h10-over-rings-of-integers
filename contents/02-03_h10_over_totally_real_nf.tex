% !TEX encoding = UTF-8
% !TEX TS-program = xelatex
% !TEX spellcheck = en_GB
% !TEX engine = xelatex
% !TEX root = ../Herbstrith-H10_over_AI.tex
%
% ██   ██  ██  ██████      ████████  ██████  ████████    ██████  ███████
% ██   ██ ███ ██  ████        ██    ██    ██    ██       ██   ██ ██
% ███████  ██ ██ ██ ██        ██    ██    ██    ██ █████ ██████  █████
% ██   ██  ██ ████  ██        ██    ██    ██    ██       ██   ██ ██
% ██   ██  ██  ██████         ██     ██████     ██       ██   ██ ███████ ██

I closely follow the papers of \textcite{Denef1980} and \textcite{Pheidas1988},
whose structure in term heavily depends on the article \citetitle{Davis1973} by
\textcite{Davis1973}. This way, one can prove the undecidability of Hilbert's
tenth problem over rings of algebraic integers in totally real number fields and
number fields with one pair of non-real embeddings and at least one real
embedding in one go. This approach is also present in Sections 6.3 and 7.2 of
the study~\cite{Shlapentokh2007} by Shlapentokh. The same author has proven the
second result independently of Pheidas in her thesis~\cite{Shlapentokh1989}.

\subsection{Finitely many easy lemmas}
% ██      ███████ ███    ███ ███    ███  █████  ███████
% ██      ██      ████  ████ ████  ████ ██   ██ ██
% ██      █████   ██ ████ ██ ██ ████ ██ ███████ ███████
% ██      ██      ██  ██  ██ ██  ██  ██ ██   ██      ██
% ███████ ███████ ██      ██ ██      ██ ██   ██ ███████

We start by defining two sequences, that satisfy Pell's equation stated below.

\begin{equation} \label{eq:Pell}
    x^2 - d y^2 = 1
\end{equation}

Using modified versions of the techniques presented
by~\textcite{Matijasevic1970}, it will be shown that the index \(m\) can be
obtained in a Diophantine way from \(\py_m(a)\) for certain subsequences of the
sequences defined below.

\begin{defin}
  Let \(K\) be an algebraic number field, \(\algint\) its ring of algebraic
  integers and fix \(a ∈ \algint\). One defines \(δ(a) := \sqrt{a^2 - 1}\) and
  \(ε(a) := a + δ(a)\), where we demand that \(-π/2 < \arg δ(a) ≤ π/2\). If
  \(δ(a) \not\in K\) one defines \(\px_m(a), \py_m(a) ∈ \algint\) for \(m ∈ ℕ\)
  by
  \begin{equation}\label{eq:def of x and y}
    \px_m(a) + δ(a) \py_m(a) = {(ε(a))}^m.
  \end{equation}
\end{defin}

This definition includes the case \(K = ℚ\) with \(\algint = ℤ\) of~\cite{Davis1973}. However, I am using the slightly modified notation of~\cite{Denef1980,Pheidas1988}.

Under the assumptions of the definition \(δ(a)\) is a root of the monic
quadratic polynomial
\[
  X^2 - a^2 + 1 ∈ \algint {[X]}.
\]
Therefore, the extension \(K[δ(a)] / K\) is quadratic and \(δ(a) ∈
\algint[{K[δ(a)]}]\). The sequences \(\px_m(a)\) and \(\py_m(a)\) are well
defined for each \(m ∈ ℕ\) as they correspond to the coefficients of
\({(ε(a))}^m\) in \(K[δ(a)]/K\) with respect to the basis \(\lbrace 1,
δ(a)\rbrace\). If the reference is clear, I will omit the dependency on \(a\)
writing \(δ, ε, \px_m\) and \(\py_m\).
% QUESTION Why does every number field contain such an element \(a\)?
\todo{Why does every number field contain such an element \(a\)?}
In the following the number field \(K[δ(a)]\) will be denoted by \(L\).

\begin{rem}
  As \(L/K\) has degree two, there is exactly one pair of field
  automorphisms\footnote{A field extension of degree two is necessarily normal.}
  on \(L\) preserving \(K\) point-wise, namely \(σ_1^{K}(α + δβ) = α + δβ\) and
  \(σ_2^K(α + δβ) = α - δβ\) for \(α, β ∈ \algint\). The latter will be denoted
  by \(\sigmaK{η} = σ_2^K(η)\) to emphasize the analogy of complex
  conjugation.
\end{rem}

\begin{exam}
  Consider the number field \(K := ℚ[√2]\). It is not hard to check that
  \(\set{1, √2}\) is an integral basis for \(\algint\). We may choose \(a = 2\)
  as the integer in the definition of the sequences. Indeed, we find \(δ =
  √{a^2 - 1} = √3\) and if \(√3\) was contained in \(K\) then it would be an
  algebraic integer. Thus there exist \(m, n ∈ ℤ\) such that
  \[
    √3 = m + n√2.
  \]
  Now since neither \(√3\) nor \(√3 / √2\) are integers, we may assume that both
  \(m\) and \(n\) are non-zero. But then
  \[
    3 = m^2 + 2 m n √2 + 2 n^2
  \]
  which is equivalent to
  \[
    √2 = \frac{3 - m^2 - 2 n^2}{2 m n} ∈ ℚ.
  \]
  Note that \(ε = a + δ = 2 + √3\) then by definition of the sequences we have
  for all \(m ∈ ℕ\) that
  \begin{align*}
    \px_m + δ\py_m &= ε^m = \left(2 + √3\right)^m =
      \sum_{j = 0}^m \binom{m}{j} 2^j √{3^{m - j}} =\\
    &= \sum_{\substack{j=0\\ j \text{ even}}}^m
          \binom{m}{j} 2^j 3^{\frac{j}{2}} +
       √3 \sum_{\substack{j=0\\ j \text{ odd}}}^m
          \binom{m}{j} 2^j 3^{\frac{j - 1}{2}}.
  \end{align*}
  Thus, we have found that
  \begin{align*}
    \px_m &= \sum_{\substack{j=0\\ j \text{ even}}}^m
          \binom{m}{j} \left(2 √3\right)^j\\
    \intertext{and}
    \py_m &= 2\sum_{\substack{j=0\\ j \text{ odd}}}^m
       \binom{m}{j} \left(2 √3\right)^{j - 1}.
  \end{align*}
\end{exam}

Let me now collect some properties of these sequences. The proofs are
generalized versions of the ones given in Davis' paper~\cite{Davis1973}.

\begin{lem}
  Let \(K\) be an algebraic number field and \(a ∈ \algint\) such that \(δ(a) \not\in K\). Then
  \begin{thmlist}
    \item\label{lem:epsilon is unit}
    \(ε\) is a unit in \(\algint[L]\), its
    inverse is given by \(ε^{-1} = a - δ = \sigmaK{ε}\), and
    \item\label{lem:x and y solve Pells equation}
    \(\px_m, \py_m\) satisfy Pell's equation~\eqref{eq:Pell} for all \(m
    ∈ ℕ\), using \(d = {δ(a)}^2\) as parameter.
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item We have \(ε \; (a - δ) = (a + δ) (a - δ) = a^2 - δ^2 = 1\) as desired.
    \item One uses induction on \(m\). If \(m = 0\), the pair \(\px_0 = 1\) and \(\py_0 =
    0\) yields a trivial solution to equation~\eqref{eq:Pell}. Let the claim be
    proven for all pairs \(\px_n, \py_n\) with \(n ≤ m\). Then rewriting the definition
    of \(\px_{m + 1}, \py_{m + 1}\) one obtains
    \[
      \px_{m + 1} + δ \py_{m + 1} = ε^{m + 1} = (\px_m + δ \py_m)ε.
    \]
    Applying the automorphism \(\sigmaK{\cdot}\) implies
    \[
      \sigmaK{\px_{m + 1} + δ \py_{m + 1}} = \px_{m + 1} - δ \py_{m + 1} = (\px_m - δ \py_m) ε^{-1}
    \]
    and multiplication of both equations yields
    \[
      \px_{m + 1}^2 - d \py_{m + 1}^2 = \sigmaK{\px_{m + 1} + δ \py_{m + 1}} (\px_{m + 1} - δ \py_{m + 1}) = 1
    \]
    as claimed.
  \end{plist}
\end{proof}

The defining equation
\[
  \px_m + δ \py_m = ε^m = {(\px_1 + δ \py_1)}^m
\]
can be seen as an analogue of the trigonometric identity
\[
  \cos m + i \sin m = e^{im} = {(\cos 1 + i \sin 1)}^m,
\]
where \(\px_m\) plays the role of \(\cos m\), \(\py_m\) the one of \(\sin m\), and \(i\) is replaced by \(δ\). In this view Pell's equation~\eqref{eq:Pell} is the analogue of the Pythagorean identity
\[
  {\cos (m)}^2 + {\sin (m)}^2 = 1.
\]

The next lemma proves the identities corresponding to \(\cos m = \Re e^{im}\),
\(\sin m = \Im e^{im}\), and the addition formulas.

\begin{lem}
  Let \(K\) be an algebraic number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\). Then for all \(m, k ∈ ℕ\) one has
  \begin{thmlist}
    \item\label{lem:real part of epsilon}
    \(\px_m = (ε^m + ε^{-m}) / 2\) and \(\py_m = (ε^m - ε^{-m}) / (2 δ)\), as well as,
    \item\label{lem:addition formulas}
    \(\px_{m ± k} = \px_m \px_k ± δ^2 \py_m \py_k\), and
    \(\py_{m ± k} = \px_k \py_m ± \px_m \py_k\).
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item In \cref{lem:epsilon is unit} we have seen that \(ε^{-1} =
    \sigmaK{ε}\) and therefore \(ε^{-m} = {\left(\sigmaK{ε}\right)}^m\). Observe that for arbitrary \(α, β ∈ \algint\) we have
    \[
      α + β y + \sigmaK{α + δ β} = 2α \quad \text{and} \quad
      α + β y - \sigmaK{α - δ β} = 2δ β.
    \]
    Now, setting \(α + δ β = ε^m\) yields the claim.
    \item By the defining equation for \(\px_m\) and \(\py_m\) we have
    \begin{align*}
      \px_{m + k} + δ \py_{m + k} &= ε^{m + k} = (\px_m + δ \py_m) (\px_k + δ \py_k) =\\
                            &= (\px_m \px_k + δ^2 \py_m \py_k) + δ (\px_m \py_k + \px_k \py_m)
    \end{align*}
    and thusly
    \begin{align*}
      \px_{m + k} &= \px_m \px_k + δ^2 \py_m \py_k, \\
      \py_{m + k} &= \px_m \py_k + \px_k \py_m.
    \end{align*}
    The identities for \(\px_{m - k}\) and \(\py_{m - k}\) follow analogously.
  \end{plist}
\end{proof}

Setting \(k = 1\) in the lemma above, one obtains \(\px_{m ± 1} = a \px_m ± δ^2
\py_m\) and \(\py_{m ± 1} = a \py_m ± \px_m\). A further immediate consequence
of this lemma is the subsequent one, which brings divisibility into play.

\begin{lem}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
  Then for all \(m, k ∈ ℕ\), \(k ≠ 0\) we have that
  \begin{thmlist}
    \item\label{lem:y m divides y mk}
    \(\py_m\) divides \(\py_{mk}\) in \(\algint\),

    \item \(\py_{mk} \equiv k \px_m^{k - 1} \py_m \mod \left(\py_m^3\right)\) in
    \(\algint\), as well as

    \item\label{lem:x m and y m are relative prime}
    the principal ideals \((\px_m)\) and \(\py_m\) are relative prime in
    \(\algint\) for all \(m ∈ ℕ\)
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item I argue by induction on \(k\). The claim is trivial if \(k = 1\) and
    \cref{lem:addition formulas} implies that
    \[
      \py_{m(k + 1)} = \px_m \py_{mk} + x{mk} \py_m.
    \]

    If the claim is proven for all factors lower than \(k + 1\), one finds that
    \(\py_m \mid \py_{mk}\) and \(\py_m \mid \py_m\) trivially. As a consequence, \(\py_m \mid
    \py_{m(k + 1)}\).

    \item Again the defining equation yields
    \begin{align*}
      \px_{mk} + δ \py_{mk} &= ε^{mk} = {(\px_m + δ \py_m)}^k =
                        \sum_{j = 0}^k \binom k j \px_m^{k - j} \py_m^j δ^j \\
      \intertext{and}
      \py_{mk} &= \sum_{\substack{j=0\\ j \text{ odd}}}^k
                \binom k j \px_m^{k - j} \py_m^j δ^{j -1}.
    \end{align*}
    In the equation above all terms for \(j > 1\) are divisible by \(\py_m^3\)
    and thusly vanish modulo \(\left(\py_m^3\right)\). The only term remaining
    is \(k \px_m^{k - 1} \py_m\) as claimed.

    \item Since \((\px_m, \py_m)\) is a solution to bells equation, we know that
    \[
      1 = \px_m^2 - (a^2 - 1) \py_m^2.
    \]
    is contained in the sum of ideals \((\px_m) + (\py_m)\) and thus the ideals
    are relative prime as claimed.
  \end{plist}
\end{proof}

The next lemma even though being easy to prove provides a valuable tool in
studying the sequences \(\px_m\) and \(\py_m\). It derives a recursive
definition and lets one prove properties of the sequences, by proving them for
\(m ∈ \lbrace 0, 1 \rbrace\) and inferring the properties for \(m + 1\) from
\(m\) and \(m - 1\).

\begin{lem}\label{lem:recursion for x_m and y_m}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in
  K\). For \(m > 1\) the following recursive conditions hold in \(\algint\).
  \begin{align*}
    \px_{m + 1} &= 2 a \px_m - \px_{m - 1}, & \px_1 = a, \;& \px_0 = 1 \\
    \py_{m + 1} &= 2 a \py_m - \py_{m - 1}, & \py_1 = 1, \;& \py_0 = 0 \\
  \end{align*}
\end{lem}
\begin{proof}
  The initial conditions follow from \(ε = a + δ\) and \(ε^0 = 1\). To prove the
  the difference equations one uses \cref{lem:addition formulas} and obtains
  \begin{align*}
    \px_{m + 1} &= a \px_m + δ^2 \py_m,  &  \py_{m + 1} &= a \py_m + \px_m, \\
    \px_{m - 1} &= a \px_m - δ^2 \py_m,  &  \py_{m - 1} &= a \py_m - \px_m.
  \end{align*}
  Summation yields \(\px_{m + 1} + \px_{m - 1} = 2 a \px_m\) and \(\py_{m + 1} + \py_{m - 1}
  = 2 a \py_m\).
\end{proof}

One applies the previous lemma to prove some congruence conditions.

\begin{lem}
  Let \(K\) be a number field and \(a, b, c ∈ \algint\) such that \(δ(a), δ(b)
  \not\in K\). Then for all \(m ∈ ℕ\) the following congruences hold in
  \(\algint\).
  \begin{plist}
    \item \(\py_m (a) \equiv m \mod (a - 1)\)
    \item If \(a \equiv b \mod (c)\), then \(\px_m (a) \equiv \px_m (b) \mod (c)\) and
    \(\py_m(a) \equiv \py_m(b) \mod (c)\).
  \end{plist}
\end{lem}
\begin{proof}
  Both congruences become equalities if \(m = 0\). As for \(m = 1\),
  the first congruence is again an equality as \(\py_1 (a) = 1\) independently of
  \(a\). The second claim is trivial since \(x_1 (η) = η\) and \(\py_1 (η) = 1\) for \(η
  ∈ \lbrace a, b \rbrace\). At this point one proceeds inductively and assumes
  the claims to be proven for all indices lower than \(m + 1\).

  \begin{plist}
    \item Note that \(a \equiv 1 \mod (a - 1)\) and thusly by
    \cref{lem:recursion for x_m and y_m}
    \[
      \py_{m + 1} = 2 a \py_m - \py_{m - 1} \equiv 2 m - (m - 1) = m + 1 \mod (a - 1)
    \]
    as claimed.

    \item Using \cref{lem:recursion for x_m and y_m} we see that for fixed \(m\)
    the coefficients \(\px_m (η)\) and \(\py_m (η)\) can be expressed as some fixed
    polynomial in \(η\). For the congruence this means
    \begin{align*}
      \px_{m + 1} (a) &= 2 a \px_m (a) - \px_{m - 1} (a)
                     \equiv 2 b \px_m (b) - \px_m{m - 1} (b) = \px_{m + 1} (b)
                     \mod (c)
    \end{align*}
    and for \(\py_{m + 1}\) completely analogously.
  \end{plist}
\end{proof}

\begin{lem}\label{lem:congruence x_2m+k}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in
  K\). Then for \(m, k ∈ ℕ\) such that \(m ± k ≥ 0\) the following congruence
  holds in \(\algint\).
  \[
    \px_{2 m ± k} \equiv - \px_k \mod (\px_m)
  \]
\end{lem}
\begin{proof}
  By applying the addition formulas of \cref{lem:addition formulas} twice and
  using that \(\px_m\) and \(\py_m\) solve Pell's equation~\eqref{eq:Pell} one obtains
  \begin{align*}
    \px_{2m ± k} &= \px_m \px_{m ± k} + δ^2 \py_m \py_{m ± k}
                \equiv δ^2 \py_m (\py_m \px_k ± \px_m \py_k) \equiv\\
               &\equiv δ^2 \py_m^2 \px_k = (\px_m^2 - 1) \px_k
                \equiv -\px_k \mod (\px_m).
  \end{align*}
\end{proof}

At this point for the first time in this section I state a result that is no
direct generalization of a result in~\cite{Davis1973} and present proofs given
in~\cite{Denef1980} or \cite{Shlapentokh2007}. Note however that the results are
nevertheless true for the case \(K = ℚ\) and \(\algint = ℤ\).

\begin{lem}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in
  K\). Then for all non-negative integers \(k, m ∈ ℕ\) the following congruence
  holds in \(\algint\).
  \[
    \px_{2km} \equiv (-1)^k \mod (\px_m)
  \]
\end{lem}
\begin{proof}
  If \(k = 0\) the congruence becomes and identity and if \(k = 1\) the claim
  follows directly from the lemma above. Assuming the claim to be proven for all
  integers lower than \(k\), we find---by applying \cref{lem:addition formulas}
  twice---that
  \begin{align*}
    \px_{2km} &= \px_{2(k-1)m}\px_{2m} + δ^2 \py_{2 (k-1) m}\py_{2m} \equiv
               (-1)^k + δ^2 \py_{2 (k-1) m}\py_{2m} = \\
              &= (-1)^k + δ^2 \py_{2 (k-1) m} \; 2 \px_m\py_m \equiv
               (-1)^k \mod (\px_m)
  \end{align*}
\end{proof}

% \begin{lem}
%   Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
%   Then for all \(η ∈ \algint \setminus \set{0}\) there exists an \(m ∈ ℕ\) such that
%   \(η \mid \py_m\) in \(\algint[{L}]\).
%   % QUESTION
%   \todo{Is \(η \mid y\) in  \(\algint\)?}
% \end{lem}
% \begin{proof}
%   The quotient of the non-trivial, finitely generated \(\algint\)-modules \(\algint[L]\) and \((2 δ η)\)
%   % TODO
%   \todo{Do I need this lemma?}
%
%   Let \(m\) be the order of the group of units in the finite ring
%   \(\algint[L]/(2 δ η)\), where \((2 δ η)\) denotes the principal ideal
%   generated by \(2 δ η\) in \(\algint[{L}]\). Then \(ε^{±m} \equiv 1 \mod (2 δ
%   η)\). Hence, \(2 δ η \mid ε^m - ε^{-m}\) in \(\algint[{L}]\) and therefore
%   \[
%     \left. η \;\middle\vert\; \frac{ε^m - ε^{-m}}{2 δ} \right.
%   \]
%   in \(\algint[{L}]\), where the right hand side equals \(\py_m\) by
%   \cref{lem:real part of epsilon}.
% \end{proof}

\begin{lem}\label{lem:subgroup of ker N L/K}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in
  K\). Then the set
  \[
    G := \set{α + δ β :
             (α, β) ∈ \algint^2
             \text{ is a solution to~\eqref{eq:Pell} with parameter } d = δ^2}
  \]
  is a subgroup of the kernel of the norm map \(N_{L/K}: U_L → U_K\), where
  \(U_K\) and \(U_L\) denote the groups of units in \(\algint\) and
  \(\algint[L]\) respectively.
\end{lem}
\begin{proof}
  First of all, note that, if \(α + δ β ∈ G\), so is \(\sigmaK{α + δ β} = α - δ
  β ∈ G\) because
  \[
    α^2 - d {(-β)}^2 = α^2 - d β^2 = 1.
  \]
  Now let \(α + δ β\) be an arbitrary element of \(G\), then
  \[
    N_{L/K}(α + δ β) = (α + δ β) \sigmaK{α + δ β} = α^2 - d β^2 = 1.
  \]
  This implies that \(α + δ β ∈ \ker N_{L / K}\) but also that \(α + δ β\) is a
  unit, as \(α - δ β\) is its inverse. The product of two arbitrary elements \(α_1 + δ β_1, α_2 + δ β_2 ∈ G\) is
  \[
    (α_1 + δ β_1)(α_2 + δ β_2) = (α_1 α_2 + δ^2 β_1 β_2) + δ (α_1 β_2 + α_2 β_1).
  \]
  We apply the automorphism \(\sigmaK{\cdot}\) and multiply to obtain
  \begin{align*}
    (α_1 α_2 + δ^2 β_1 β_2)^2 - δ^2 (α_1 β_2 + α_2 β_1)^2 &=
    (α_1 + δ β_1)(α_2 + δ β_2)\,\sigmaK{(α_1 + δ β_1)(α_2 + δ β_2)} =\\
    &=
    (α_1 + δ β_1)\sigmaK{α_1 + δ β_1}(α_2 + δ β_2)\sigmaK{α_2 + δ β_2} = 1.
  \end{align*}
  As a consequence, \(G\) is closed under multiplication and the claim is
  proven.
\end{proof}

\begin{lem}\label{lem:rank of N_L/K U_L}
  Let \(L\) and \(K\) be number fields as defined above.
  The image \(N_{L / K}\left(U_L\right) ≤ U_K\) has finite index in \(U_K\).
\end{lem}
\begin{proof}
  I claim that \(N_{L / K}\left(U_L\right)\) contains \(α^2\) for every \(α ∈ U_K\).
  This is because the restriction \(σ_i^K|_{\algint}\) is just the identity on
  \(\algint\) for \(i ∈ \set{1, 2}\) and therefore, \(N_{L / K}(α) = α^2\) for all
  \(α ∈ U_K \subseteq U_L\).

  Let now \(k := \rk U_K\) and identify \(U_K = μ(K) \times ℤ^{k}\), where
  \(μ(K)\) is the finite cyclic group of roots of unity in \(K\)
  (cf.~\cref{thm:Dirichlet}). Consider the following \(k\) elements
  \[
    ([0],1,0,…,0), \; ([0],0,1,0,…,0), \; …, \; ([0], 0, …, 0, 1)
  \]
  contained in \(U_K\). By the claim their ‘squares’ are contained in \(N_{L / K}\left(U_L\right)\) i.e.
  \[
    ([0],2,0,…,0), \; ([0],0,2,0,…,0), \; …, \; ([0], 0, …, 0, 2) ∈ N_{L / K}\left(U_L\right).
  \]
  As a consequence, the direct product
  \[
    G := \set{[0]} \times \underbrace{2 ℤ \times … \times 2 Z}_{k\text{-times}}
  \]
  is a subgroup of \(N_{L / K}\left(U_L\right)\) and therefore
  \[
    [U_K : N_{L / K}\left(U_L\right)] ≤ [U : G] = ℓ\, 2^k < ∞.
  \]
\end{proof}

As for the free ranks of \(U_K\), \(U_L\), \(N_{L / K}\left(U_L\right)\) and
\(G\) the lemma above implies that \(\rk N_{L / K}\left(U_L\right) = \rk U_K\)
and therefore, as an immediate consequence of the first isomorphism
theorem~\cite[see][II~§1, p.~89]{Lang2002} the following inequality holds
\begin{equation}\label{eq:rank of G}
    \rk G ≤ \rk \ker N_{L / K} = \rk U_L - \rk U_K.
\end{equation}

Before proving the main result of this section (\cref{cor:ZZ is Diophantine over
O K}) I sketch how \textcite{Davis1973} proceeds in proving the
\textsc{DPRM}-theorem.

\DPRM*

First he proves using the sequences above that the exponential function is
Diophantine over \(ℕ\) \cite[Thm 3.3]{Davis1973}. Then he is able to extend the
language of Diophantine predicates by \emph{bounded existential} and
\emph{bounded universal quantifiers}, i.e.\ by
\begin{align*}
  {(∃y)}_{≤x}ϕ(x, y) \quad &⇔ \quad ∃y\; (y ≤ x ∧ ϕ(x, y)),\\
  {(∀y)}_{≤x}ϕ(x, y) \quad &⇔ \quad ∀y\; (y > x ∨ ϕ(x, y))
\end{align*}
where \(ϕ\) is a positive existential formula~\cite[Thm 5.1]{Davis1973}. The
first one is easily seen to be Diophantine as the order relation on \(ℕ\) is
Diophantine. Proving the second claim takes the rest of the section. Now using
this result together with the sequence number theorem~\cite[Thm 1.3]{Davis1973}
Davis proofs that a function is Diophantine over \(ℕ\) if and only if it is
computable~\cite[Thm 6.1]{Davis1973}.

This already implies the \textsc{DPRM}-theorm as Davis has introduced
Diophantine pairing functions in~\cite[Thm 1.1]{Davis1973} and therefore all
ranges of Diophantine---and therefore all computable functions---are Diophantine
over \(ℕ\). But the ranges of computable functions are exactly the
semi-decidable subsets of \(ω\) by \cref{pro:characterizations of ce sets}, thus
proving the claim of the theorem.

\subsection{Diophantine definition of \(ℤ\) over \(K\)}
% ██████  ██  ██████  ██████  ██   ██        ██████  ███████ ███████
% ██   ██ ██ ██    ██ ██   ██ ██   ██        ██   ██ ██      ██
% ██   ██ ██ ██    ██ ██████  ███████        ██   ██ █████   █████
% ██   ██ ██ ██    ██ ██      ██   ██        ██   ██ ██      ██
% ██████  ██  ██████  ██      ██   ██ ██     ██████  ███████ ██   ██

For the remainder of this section let \(K ≠ ℚ\) be a totally real number field
or a number field with exactly one pair of non-real embeddings of degree \(n :=
[K : ℚ] ≥ 3\) over the rationals \(ℚ\). For any number field \(K\) we set
\(r_K\) to be the number of real embeddings of \(K\) and \(s_K\) to be the
number of pairs of complex-conjugate embeddings of \(K\). Then the conditions on
the number fields we are considering in this section can be restated as \(r_K =
n > 1\), or \(r_K = n - 2 > 0\) and \(s_K = 1\) respectively. As before we set
\(L = K[{δ(a)}]\), where \(δ(a) \not\in \algint\) is a root of \(X^2 - a^2 + 1\)
and \(-π/2 < \arg δ(a) ≤ π/2\).

Furthermore, let us assume that \(σ_1 = \id_K, σ_2, …, σ_n: K → ℂ\) are all
embeddings of \(K\) into the complex pane \(ℂ\). If \(s_K = 1\) we demand
without loss of generality that \(K, σ_2(K) \not\subset ℝ\) and that \(σ_2(α) =
\overline{α}\) for all \(α ∈ K\). In other words, \((σ_1, σ_2)\) is the pair of
complex embeddings and all other morphisms embed \(K\) into the reals \(ℝ\).

\begin{lem}\label{lem:L over K is quadratic}
  Let \(K ≠ ℚ\) be a number field of degree \(n\) over \(ℚ\). If \(a ∈ \algint\)
  satisfies
  \begin{equation}\label{eq:approximations of a}
    \begin{cases}
      r_K = n > 1\\
      a > 2^{2(n + 1)}\\
      0 < σ_i(a) < \frac{1}{2} &\text{for } 1 < i ≤ n
    \end{cases}
    \quad \text{or} \quad
    \begin{cases}
      r_K = n - 2 > 0\\
      |σ_i(a)| > 2^{2(n + 1)} &\text{for } i ∈ \set{1, 2}\\
      0 < σ_i(a) < \frac{1}{2} &\text{for } 2 < i ≤ n
    \end{cases},
  \end{equation}
  then \(δ(a) = \sqrt{a^2 - 1}\) is not contained in \(K\).
\end{lem}
\begin{proof}
  By assumption we have \(0 < σ_n(a) < 1/2\) and therefore \(σ_n(a)^2 - 1 < 0\)
  cannot be a square in the real number field \(σ_n(K) \subseteq ℝ\). As \(K\)
  is isomorphic to \(σ_n(K)\), the algebraic integer \(δ(a) = \sqrt{a^2 - 1}\)
  cannot be contained in \(K\).
\end{proof}

We will prove later using Minkowski's theorem on convex bodies
(\ref{thm:Minkowski}), that an algebraic integer \(a ∈ \algint\) satisfying
\eqref{eq:approximations of a} exists and therefore the condition on \(a\) from
the previous section holds.

\begin{exam}
  Consider again the case of \(K := ℚ[√2]\). Since both embeddings of \(K\)
  into \(ℂ\) are uniquely determined by \(σ(√2) = ± √2\) it suffices to find two
  integers \(k, ℓ ∈ ℤ\) such that \(|k + ℓ √2| > 2^{2 \cdot 2 + 2} = 64\) and
  \(|k - ℓ √2| < 1/2\). Then we can set \(a := k + ℓ √2\) and the \(a\) fulfils
  \eqref{eq:approximations of a}. Such a pair of integers is given by \(a = 34 +
  24 √2\). In this case
  \[
    δ = \sqrt{4 {\left(12 \sqrt{2} + 17\right)}^{2} - 1}.
  \]
\end{exam}

\begin{rem}
  As the expansion \(L / K\) is quadratic by \cref{lem:L over K is
  quadratic}, every \(σ_i\) can be extended to exactly two embeddings \(σ_{i1}\)
  and \(σ_{i2}\) of \(L\) into the complex plane \(ℂ\) by ‘composing’ with
  \(σ_1^K\) or \(σ_2^K\). This yields
  \begin{equation}\label{eq:def of sigma ij}
    \begin{aligned}
      σ_{i1}(α + δβ) &= σ_i(α) + \sqrt{{σ_i(a)}^2 - 1}\, σ_i(β) \quad \text{and} \\
      σ_{i2}(α + δβ) &= σ_i(α) - \sqrt{{σ_i(a)}^2 - 1}\, σ_i(β)
    \end{aligned}
  \end{equation}
  for all \(α, β ∈ \algint\) and all \(1 ≤ i ≤ n\).
\end{rem}

I will identify the field \(L\) with its embedding \(σ_{11}(L)\) and write \(x\)
instead of \(σ_{11}(x)\) for its elements.

\begin{lem}\label{lem:r and s for tr and opnr}
  Let \(K ≠ ℚ\) be a number field of degree \(n\) over \(ℚ\) and let \(a ∈
  \algint\) be such that \eqref{eq:approximations of a} is satisfied. Then
  \begin{thmlist}
    \item if \(r_K = n\), only \(σ_{11}\) and \(σ_{12}\) embed \(L\) into the
    reals, and
    \item if \(r_K = n - 2\), the field \(L\) is totally complex.
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item If \(K\) is totally real and \(i > 1\), then \(0 < σ_i(a) < 1/2\) and
    therefore the radicands in \eqref{eq:def of sigma ij} are both negative. As
    a consequence, \((σ_{i1}, σ_{i2})\) is a pair of non-real embeddings.

    On the other hand, if \(i = 1\) then \(a > 2^{2(n + 1)} > 1\) and the
    radicands are both positive. We deduce that \(σ_{11}\) and \(σ_{12}\) are
    both real embeddings and \(L\) is a subfield of the reals by our
    identification.

    \item As \(σ_1\) and \(σ_2\) are already non-real embeddings and \(σ_i^K\)
    preserve \(σ_j(K)\) point-wise (\(1 ≤ i, j ≤ 2\)), \(σ_{11}, σ_{12},
    σ_{21}\) and \(σ_{22}\) are non-real as well. For the remaining embeddings
    one argues completely analogously to (i).
  \end{plist}
\end{proof}

\begin{lem}\label{lem:properties of sigma epsilon}
  Let \(K ≠ ℚ\) be a number field of degree \(n\) over \(ℚ\) and let \(a ∈
  \algint\) be such that \eqref{eq:approximations of a} is satisfied. If \(s_K\)
  is the number of pairs of non-real embeddings of \(K\), then
  \begin{thmlist}
    \item \(σ_{i1}(ε)^{-1} = σ_{i2}(ε)\) for all \(1 ≤ i ≤ n\),

    \item \(σ_{i1}(ε)\) and \(σ_{i2}(ε)\) are complex conjugates for \(s_K + 1 <
    i ≤ n\), and

    \item\label{lem:modulus of sigma epsilon}
    \(|σ_{i1}(ε)| = |σ_{i2}(ε)| = 1\) for \(s_K + 1 < i ≤ n\).
  \end{thmlist}
\end{lem}
\begin{proof}
  In \cref{lem:epsilon is unit} we have seen, that the claim holds true for \(i
  = 1\). We extend this method to obtain the results for the other cases. For
  all \(1 ≤ i ≤ n\) we have
  \begin{align*}
    σ_{i1}(ε) σ_{i2}(ε) &= (σ_i(a) + σ_{i1}(δ)) (σ_i(a) - σ_{i1}(δ)) =\\
      &= σ_i(a)^2 - σ_{i1}(δ)^2 = σ_i(a)^2 - σ_i(a)^2 + 1 = 1.
  \end{align*}

  For all \(s_K + 1 < i ≤ n\) we have defined \(σ_i: K → ℂ\) to be a real
  embedding. Thus \(σ_i(a)\) is a real number and as \(0 < σ_i(a) < 1/2\), we
  find that \(σ_{i1}(δ)\) is purely imaginary. Hence, we deduce that
  \(σ_{i1}(ε)\) and \(σ_{i2}(ε)\) are complex conjugates. But then the complex
  moduli of these algebraic integers must coincide, leaving no other option than
  \(|σ_{i1}(ε)| = |σ_{i2}(ε)| = 1\).
\end{proof}

Before we can start proving some approximations for the complex moduli of \(ε,
δ\) and \(a\), we need to fix some notations.

\begin{defin}
  Let \(K ≠ ℚ\) be a number field of degree \(n\) over \(ℚ\) and let \(a ∈
  \algint\) be such that \eqref{eq:approximations of a} is satisfied. For \(1 ≤
  i ≤ n\) we set
  \begin{thmlist}
    \item \(a_i := σ_{i}(a)\),
    \item \(ε_i := σ_{i1}(ε)\) if \(|σ_{i1}(ε)| ≥ 1\) and \(ε_i := σ_{i2}(ε)\)
    otherwise, and
    \item \(δ_i := σ_{i1}(δ)\).
  \end{thmlist}
\end{defin}

\begin{rem}
  \begin{exlist}
    \item In the definition above we could have equivalently defined \(ε_i :=
    σ_{i1}(ε)\) for \(s_K + 1 < i ≤ n\), as by \cref{lem:modulus of sigma
    epsilon} the complex modulus of \(σ_{i1}(ε)\) is \(1\).

    \item Note that by \eqref{eq:def of sigma ij} we have \(σ_{i2}(δ) = -δ_i\)
    and therefore \(|δ_i| = |σ_{i2}(δ)|\) for all \(1 ≤ i ≤ n\).
  \end{exlist}
\end{rem}

We will use the following fact from number theory.

\begin{lem}
  If an algebraic integer \(η\) and all its conjugates have complex
  modulus \(1\), then \(η\) is a root of unity.
\end{lem}
\begin{proof}
  Let \(η = \seq{η}\) be all the conjugates of \(η\). Consider the polynomial
  \[
    f_k(X) := (X - η_1^k)…(X - η_n^k) = X^n + a_{k, n - 1} X^{n - 1} + … + a_{k, 0}
  \]
  for all integers \(k ∈ ℕ\). Since \(f_k ∈ ℤ[X]\) has integral coefficients and
  all \(|η_i| = 1\), we find that \(|a_{k, s}| ≤ \binom{n}{s}\). This implies
  that there can only be finitely many different \(f_k\). Now choose \(ℓ > k\)
  with \(f_ℓ = f_k\), then \(η^ℓ = η^k\) and \(η\) is a \((ℓ - k)\)-th root of
  unity.
\end{proof}

\begin{lem}
  Suppose \(K ≠ ℚ\) is a number field of degree \(n\) over \(ℚ\) and let \(a ∈
  \algint\) be such that \eqref{eq:approximations of a} is satisfied.
  Then the following inequalities hold.
  \begin{thmlist}
    \item\label{lem:approx for delta i 1}
    \(|a_i|/2 < |δ_i| < |a_i| + 1\) for \(1 ≤ i ≤ s_K + 1\).

    \item\label{lem:approx for delta i 2}
     \(1/2 < | δ_i | < 1\) for \(s_K + 1 < i ≤ n\).

    \item\label{lem:modulus of elements in the kernel}
     If \(η ∈ \ker N_{L/K}\) then \(|σ_{ij}(η)| = 1\) for \(s_K + 1 < i ≤ n\)
     and \(j ∈ \set{1, 2}\). Furthermore, \(|η| = 1\) if and only if  \(η\) is a
     root of unity.

    \item \(\left\vert |a| - \sqrt{|a^2 - 1|} \right\vert < 1\).

    \item\label{lem:approximation of epsilon with a}
     \(|a| < |ε_1| < 2|a| + 1\).

    \item\label{lem:epsilon is not a root of unity}
    \(ε\) is not a root of unity.
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item By assumption we have \(|a_i| > 2^{2(n + 1)}\) and therefore
      \begin{align*}
        \frac{|a_i|^2}{4} &= |a_i|^2 - \frac{3a_i^2}{4} ≤
            |a_i|^2 - \frac{3}{4} 2^{4(n + 1)} < |a_i|^2 - 1 ≤\\
          &≤ |δ_i| = |a_i^2 - 1| ≤ |a_i|^2 + 1 < (|a_i| + 1)^2
      \end{align*}

    \item Again by our assumption \(|a_i| < 1/2\). Thus, we find
    \[
      \frac{1}{4} < \frac{3}{4} < 1 - a_i^2 = |δ_i|^2 < 1.
    \]

    \item As in \cref{lem:properties of sigma epsilon} one uses that
    \(\overline{σ_{i1}(δ)} = σ_{i2}(δ)\) for all \(s + 1 < i ≤ n\) and finds
    for \(η = α + δ β ∈ \ker N_{L /K}\) that
    \begin{align*}
      σ_{i1}(η) &= σ_i(α) + σ_{i1}(δ) σ_i(β) \text{ and}\\
      σ_{i2}(η) &= σ_i(α) + σ_{i2}(δ) σ_i(β) = σ_i(α) - σ_{i1}(δ) σ_i(β)
    \end{align*}
    are complex conjugates. Now one can deduce,
    \[
      1 = N_{L/K}(η) = σ_{i1}(η) σ_{i2}(η) = |σ_{ij}(η)|^2
    \]
    for both \(j = 1\) and \(2\).

    To prove the second part of the claim, we notice that all roots of unity
    have complex modulus \(1\), so one direction is trivial. Let now \(η = α +
    δ β ∈ \ker N_{L / K}\) and additionally \(|η| = 1\), we differentiate two
    cases. If \(K\) is totally real, then all embeddings of the algebraic
    integer \(η\) have complex modulus \(1\). Therefore, \(η\) is a root of
    unity.

    If on the other hand, \(s_K = 1\), then note firstly, that the complex
    conjugate \(\overline{δ}\) is a root of the polynomial
    \[
      X^2 - \overline{a}^2 + 1 = X^2 - σ_2(a) + 1.
    \]
    As a consequence, \(σ_{2j}(δ) = (-1)^{1 + j} \overline{δ}\) for \(j ∈
    \set{1, 2}\). We deduce that
    \[
      \overline{σ_{11}(η)} = \overline{η} = \overline{α + δ β} = σ_2(α) +
      σ_{21}(δ) σ_{2}(β) = σ_{21}(η)
    \]
    and
    \[
      \overline{σ_{12}(η)} = \overline{α - δ β} = σ_2(α) - σ_{21}(δ) σ_{2}(β)
      = σ_{21}(η) = σ_2(α) + σ_{22}(δ) σ_{2}(β) = σ_{22}(η).
    \]
    This implies that \(|σ_{21}(η)| = |η| = 1\) and
    \(|σ_{22}(η)| = |σ_{12}(η)|\). Finally, note that \(N_{L / ℚ} = N_{K / ℚ}
    \circ N_{L / K}\) and therefore
    \[
      1 = |N_{K / ℚ}(1)| = |N_{K / ℚ} \circ N_{L / K} (η)| =
          \left\vert
            \prod_{\substack{1 ≤ i ≤ n\\ 1 ≤ j ≤ 2}} σ_{ij}(η)
          \right\vert = |σ_{12}(η)| |σ_{22}(η)| = |σ_{12}(η)|^2.
    \]

    \item The inequality
    \[
      0 ≤ \left\vert |a| - \sqrt{|a^2 - 1|} \right\vert < 1
    \]
    is equivalent to \(|a|^2 - 2 |a| + 1 < |a^2 - 1|\). But this inequality can
    easily seen to be satisfied, as
    \[
      |a|^2 + 1 < |a|^2 + 2|a| - 1 = |a^2 - 1| + 2 |a|
    \]
    and the claim is proven.

    \item Consider the inequality
    \[
      |ε_1|^2 = |a + δ_1|^2 = |a^2 + 2 a δ_1 + δ_1^2| ≥ |2a^2 + 2a δ_1| - 1 =
                2 |a| |ε_1| - 1
    \]
    which can be rewritten as
    \[
      0 ≤ |ε_1|^2 - 2 |a| |ε_1| + 1 =
          \left(|ε_1| - |a| - \sqrt{|a|^2 - 1}\right)
          \left(|ε_1| - |a| + \sqrt{|a|^2 - 1}\right)
    \]
    Thus, either both factors are negative real numbers or both are positive. In
    the first case
    \[
      0 < |ε_1| < |a| - \sqrt{|a|^2 - 1} \overset{\text{by (iv)}}{<} 1,
    \]
    which is impossible. Hence, both factors are positive and
    \[
      |ε_1| > |a| + \sqrt{|a|^2 - 1}  > |a|,
    \]
    proving the first estimate. The second inequality follows from \(|ε_1| = |a
    + δ_1| < 2|a| + 1\) by (i).
    % QUESTION Can one get rid of the \(+ 1\)? I doubt the proof of
    % Shlapentokh, but will check, if the stronger estimate is needed. It seems
    % that it is not needed.
    \todo{Can one get rid of the \(+ 1\)? I doubt the proof of Shlapentokh, but
    will check, if the stronger estimate is needed. It seems that it is not
    needed.}

    \item Note that by (v), \(|ε_1| > |a| > 2^{2(n + 1)} > 1\) and therefore the
    complex modulus of \(ε\) cannot be equal to \(1\). The claim follows from
    (iii).
  \end{plist}
\end{proof}

As a next step, we want to show that we have essentially found all solutions of
Pell's equation~\eqref{eq:Pell}. For this we need some lemmas.

Recall the group \(G ≤ \ker N_{L / K}\) defined in \cref{lem:subgroup of ker N
L/K}. We have seen in \cref{lem:rank of N_L/K U_L} and the subsequent
inequality~\eqref{eq:rank of G} that the free rank of \(G\) can be bound from
above by \(\rk U_L - \rk U_K\). I claim that this difference of ranks is equal
to \(1\) in both cases of algebraic number fields we are considering.

If \(K ≠ ℚ\) is totally real, then by Dirichlet's unit
theorem~(\ref{thm:Dirichlet}) we find that \(\rk U_K = n\) and by \cref{lem:r
and s for tr and opnr} that \(\rk U_L = 1 + n\). If on the other hand, \(K\)
satisfies \(r = n - 2 > 0\) then \(\rk U_K = n - 1\) and by \cref{lem:r and s
for tr and opnr} we have \(\rk U_L = n\).

Note that \(ε\) is contained in \(G\) and by the previous lemma, \(ε\) is not a
root of unity. As a consequence, the group \(⟨ε⟩ ≤ G\) has free rank at least
equal to \(1\). We deduce that
\[
  \rk ⟨ε⟩ = \rk G = 1.
\]
Thus, there exists a unit \(ε_0 ∈ G\) such that for all \(η ∈ G\)  there exists
a root of unity \(ζ\) and an integer \(k\), such that \(η = ζ ε_0^k\). However,
even more is true, as one can set \(ε = ε_0\), but before we can prove
this, we need a lemma.

\begin{lem}
  Let \(K ≠ ℚ\) be a number field and let \(a ∈ \algint\) satisfy
  \eqref{eq:approximations of a}. Furthermore, let \(ε_0\) be a generator of the
  torsion free part of \(G\). Then \(2δ \mid (ε_0 - ε_0^{-1})\) and
  \begin{thmlist}
    \item if \(K\) is totally real, then
    \[
      |N_{L/ℚ} (2 δ)| > a^2 \quad \text{ and } \quad
      |N_{L/ℚ} (ε_0 - ε_0^{-1})| < 2^{2n} |ε_0|^2;
    \]

    \item if \([K: ℚ] ≥ 3\) and \(K\) has exactly one pair of non-real embeddings, then
    \[
      |N_{L/ℚ} (2 δ)| > a^4 \quad \text{ and } \quad
      |N_{L/ℚ} (ε_0 - ε_0^{-1})| < 2^{2n} |ε_0|^4.
    \]
  \end{thmlist}
\end{lem}
\begin{proof}
  Let \(ε_0 = α + δβ\) for some \(α, β ∈ \algint\), then \(ε_0^{-1} = α - δ β\)
  (cf.~\cref{lem:subgroup of ker N L/K}) and
  \[
    ε_0 - ε_0^{-1} = 2δ\, β,
  \]
  proving that \(2δ \mid (ε_0 - ε_0^{-1})\).

  We assert without loss of generality that \(ε = ζε_0^k\), where \(|ε_0| ≥ 1\).
  Then for all \(1 ≤ i ≤ n\) and all \(1 ≤ j ≤ 2\), we have
  \[
    |σ_{ij}(ε)| = |σ_{ij}(ζε_0^k)| = |σ_{ij}(ε_0)|^k,
  \]
  and thus, \(|ε_1| = |ε_0|^k ≥ |ε_0| ≥ 1\). Furthermore, by \cref{lem:modulus
  of elements in the kernel} the following inequality holds
  \begin{equation}\label{eq:approximation of epsilon 0}
    |σ_{i1}(ε_0) - σ_{i1}(ε_0^{-1})| |σ_{i2}(ε_0) - σ_{i2}(ε_0^{-1})| =
    |σ_{i1}(ε_0) - σ_{i1}(ε_0^{-1})|^2 ≤ 2^2
  \end{equation}
  for all \(s_K + 1 < i ≤ n\).

  \begin{plist}
    \item If \(K ≠ ℚ\) is totally real, then by \cref{lem:approx for delta i 1}
    and (ii) we find that
    \[
      |N_{L/ℚ}(2δ)| = 2^{2n} \prod_{i = 1}^n |δ_i|^2 >
        \frac{2^{2n}}{2^{2n - 2}} \frac{|a|^2}{4} = a^2.
    \]

    To see the second inequality, we use \eqref{eq:approximation of epsilon 0}
    to find
    \begin{align*}
      |N_{L/ℚ}(ε_0 - ε_0^{-1})| &=
        \prod_{\substack{1 ≤ i ≤ n\\1 ≤ j ≤ 2}} |σ_{ij}(ε_0) - σ_{ij}(ε_0^{-1})|
        \prod_{i = 1}^n |σ_{i1}(ε_0) - σ_{i1}(ε_0^{-1})|^2 ≤ \\
        &≤ 2^{2n - 2} |ε_0 - ε_0^{-1}|^2 ≤ 2^{2n - 2} (|ε_0| + 1)^2
        < 2^{2n} |ε_0|^2
    \end{align*}
    as claimed.

    \item Completely analogously using the fact, that
    \begin{align*}
      &|σ_{11}(ε_0) - σ_{11}(ε_0)| |σ_{12}(ε_0) - σ_{12}(ε_0)|
      |σ_{21}(ε_0) - σ_{21}(ε_0)| |σ_{22}(ε_0) - σ_{22}(ε_0)| =\\
      &|σ_{11}(ε_0) - σ_{11}(ε_0)|^2 |\overline{σ_{21}(ε_0) - σ_{21}(ε_0)}|^2 =
      |σ_{11}(ε_0) - σ_{11}(ε_0)|^4.
    \end{align*}
  \end{plist}
\end{proof}

\begin{pro}\label{pro:epsilon essentially generaltes G}
  Let \(K ≠ ℚ\) be a number field and let \(a ∈ \algint\) satisfy
  \eqref{eq:approximations of a}. Then for every \(η ∈ G\) there exists an
  integer \(k\) and a root of unity \(ζ ∈ L\) such that \(η = ζ ε^k\).
\end{pro}
\begin{proof}
  By the discussion above all that is left to prove is that in the equation
  \[
    ε_1 = ζε_0^k
  \]
  with \(|ε_0| ≥ 1\) the integer \(k\) is \(1\). Then
  \[
    ε_0 = ζ^{-1}ε_1 = ζ^{-1}ε^{± 1}
  \]
  and the proposition is proven.

  Assume to the contrary, that \(k ≥ 2\), then \(|ε_1| ≥ |ε_0|^2 ≥ 1\).
  By the lemma above \(2δ \mid (ε_0 - ε_0^{-1})\) and therefore
  \[
    N_{L / K}(2δ) ≤ N_{L / K}(ε_0 - ε_0^{-1}).
  \]
  The previous lemma implies now that \(1 < |a|^{2m_0} < 2^{2n}|ε_0|^{2m_0}\),
  where \(m_0 ∈ \set{1, 2}\) is chosen accordingly. Applying
  \cref{lem:approximation of epsilon with a} yields
  \[
    |a|^{2 m_0} < 2^{2n} |ε_0|^{2 m_0} ≤ 2^{2n} |ε_1|^{m_0} <
            2^{2n + m_0} {(|a| + 1)}^{m_0} < 2^{2n + 1 + m_0} |a|^{m_0}.
  \]
  If \(m_0\) is one then the inequality above reads \(|a|^2 < 2^{2n + 2}|a|\),
  which is a contradiction to \eqref{eq:approximations of a}. If on the other
  hand \(m_0 = 2\) holds then we obtain \(|a|^4 < 2^{2n + 3} |a|^2\). But this
  can be transformed upon dividing by \(|a|^2\) and taking square roots to
  \(|a| < 2^{n + 3/2}\), which is again a contradiction to
  \eqref{eq:approximations of a}.
\end{proof}

Recall the sequences \((\px_m)_{m ∈ ℕ}\) and \((\py_m)_{m ∈ ℕ}\) defined in
\eqref{eq:def of x and y}. If \(K\) is totally real we can conclude from the
proposition above that all solutions of Pell's equation with the parameter \(d =
a^2 - 1\) are of the form
\[
  (±\px_m(a), ±\py_m(a))
\]
for some integer \(m ∈ ℕ\). This is because \(L = K[√d]\) has two real
embeddings (\(σ_{1,1}\) and \(σ_{1,2}\)) and the only real roots of unity are
\(±1\). If \(K\) has one pair of non-real embeddings and at least one real
embedding. This argument can no longer be used as \(L\) is totally complex in
this case. One can however impose a Diophantine condition on the solutions of
Pell's equation to force them to be of this shape
\cite[cf.][Lem.~3]{Pheidas1988}.

\begin{cor}
  Let \(K\) be a number field of positive degree \(n\) over \(ℚ\) and let \(a ∈
  \algint\) satisfy \eqref{eq:approximations of a}. Then there exists a
  constant \(ν ∈ ℕ \setminus \set{0}\) with the property, that if \(x'+
  δ y') ∈ G\) and
  \begin{equation}\label{eq:forcing solutions to be sequences}
     {(x' + δ y')}^{ν} = x + δ y
  \end{equation}
  for two algebraic integers \(x, y ∈ \algint\) then there exists an index \(m
  ∈ ℕ\) such that
  \[
    (x, y) = (±\px_m, ±\py_m).
  \]
  In particular, \((x, y)\) is a solution to Pell's equation.
\end{cor}
\begin{proof}
  Set \(ν := |μ(K)|\) which is finite by Dirichlet's unit
  theorem~(\ref{thm:Dirichlet}). By the proposition there exists a root of
  unity \(ζ ∈ L\) and an integer \(m_1 ∈ ℕ\) such that \(ζε^{m_1} = x' + δ y'\).
  We conclude that
  \[
    x + δ y = (x' + δ y')^ν = (ζ ε^{m_1})^ν = ζ^ν ε^{m_1 ν} = ε^{m_1 ν}
  \]
  and therefore that \((x, y) = (±\px_{m_1 ν}, ±\py_{m_2 ν})\). The claim
  follows from \cref{lem:x and y solve Pells equation}.
\end{proof}

Note that \eqref{eq:forcing solutions to be sequences} is not a Diophantine
relation over \(\algint\) as \(δ\) not contained in \(K\). We can however use
the binomial theorem to rewrite the identity as
\[
  x + δ y = {(x' + δ y')}^{ν} = \sum_{i = 0}^ν \binom{ν}{i} x'^{ν - i} δ^i y'^i
\]
and by equating coefficients of \(δ\) we get the two Diophantine definitions
\begin{align*}
  x &= \sum_{\substack{i = 1\\i \text{ even}}}^ν
          \binom{ν}{i} x'^{ν - i} (a^2 - 1)^{\frac{i}{2}} y'^i\\
  \intertext{and}
  y &= \sum_{\substack{i = 1\\i \text{ odd}}}^ν
          \binom{ν}{i} x'^{ν - i} (a^2 - 1)^{\frac{i - 1}{2}} y'^i\\
\end{align*}
As a next step we derive further properties of the sequences \((\px_m)_{m ∈ ℕ}\)
and \((\py_m)_{m ∈ ℕ}\).

\begin{lem}
  Let \(K ≠ ℚ\) be a number field and let \(a ∈ \algint\) satisfy
  \eqref{eq:approximations of a}. Then the following inequality holds
  \[
    m < |σ_i(\px_m)|
  \]
  for all non-negative integers \(m ∈ ℕ\) and all \(1 ≤ i ≤ s_K + 1\).
\end{lem}
\begin{proof}
  By \cref{lem:approximation of epsilon with a} we know that \(|ε_1| > |a| > 1\)
  and since \(ε_1 = ε^{±1}\), \cref{lem:real part of epsilon} implies
  \[
    |x_m| = \frac{|ε_1^m + ε_1^{-m}|}{2} ≥ \frac{|ε_1|^{m} + 1}{2}
    > \frac{|a|^{m} + 1}{2} > \frac{2^{2(n+1)m} + 1}{2} > m
  \]

  If \(s_K = 1\), then \(σ_2(\px_m)\) is the complex conjugate of \(σ_1(\px_m) =
  \px_m \). As a consequence, their moduli must coincide.
\end{proof}

\begin{lem}\label{lem:approximations of sigma x and sigma y}
  Let \(K ≠ ℚ\) be a number field and let \(a ∈ \algint\) satisfy
  \eqref{eq:approximations of a}. There exists a constant \(C\) depending on
  \(K\) and \(a\) such that for all \(k ∈ ℕ \setminus \set{0}\) there exist \(m,
  h ∈ ℕ\) with \(k \mid m\) and \(k \mid h\), and
  \begin{align*}
    |σ_i(\px_m)| &> \frac{1}{2},\\
    |σ_i(\py_h)| &> C
  \end{align*}
  for \(s_K + 1 < i ≤ n\).
\end{lem}
\begin{proof}
  Fix any positive integer \(k\). By \cref{lem:modulus of sigma epsilon} we know
  that \(|ε_j| = 1\) for \(s_K + 1 < j ≤ n\), but in the same lemma we have
  proven, that \(ε\) is not a root of unity. It follows that there exist
  arguments \(ϑ_{s_K + 2}, …, ϑ_n ∈ ℝ\) such that
  \[
    ε_j = e^{i π ϑ_j}.
  \]
  Let \(A = \set{ϑ_{j_1}, …, ϑ_{j_s}}\) be a maximal \(ℤ\)-linear independent
  subset of \(\set{ϑ_{s_K + 2}, …, ϑ_{n}}\). Since \(ε\) is not a root of unity,
  none of the \(ϑ_j\) can be rational. Indeed, if \(ϑ_j = p/q\) then \(ε_j^{2q}
  = e^{i π 2 p} = 1\) and \(ε_j\) is a root of unity. Hence, \(A\) contains at
  least one element.

  Let \(J_0 := \set{\seq[s]{j}}\) be the set of indices of elements in \(A\),
  then the construction implies that for all \(s_K + 1 < r ≤ n\) there exist
  integers \(b_r, b_{rj} ∈ ℤ\) with \(b_r ≠ 0\) such that
  \[
    b_r ϑ_r = \sum_{j ∈ J_0} b_{rj} ϑ_j.
  \]
  For otherwise, \(1, ϑ_{j_1}, …, ϑ_{j_s}, ϑ_{r}\) would be \(ℚ\)-linear
  independent, contradicting the maximality of \(A\). In other words, we have
  that
  \[
    ε_r^{b_r} = \prod_{j ∈ J_0} ε_j^{b_{rj}}.
  \]
  We set \(b := \prod_{r = s_K + 2}^n b_r ≠ 0\) and find for all \(s_K + 1 < r ≤
  n\) integers \(c_{rj} ∈ ℤ\) with
  \[
    ε_r^b = \prod_{j ∈ J_0} ε_j^{c_{rj}}.
  \]

  We exponent this expression by a multiple \(ℓ ∈ kℤ\) of \(k\), whose value
  will be fixed later, and rewrite it to obtain
  \begin{align}
    \begin{split}\label{eq:approximation of sigma x and sigma y}
        σ_r(\px_{ℓb}) + σ_{r1}(δ) σ_t(\py_{rb}) &= ε_r^{ℓb} =
            \prod_{j ∈ J_0} ε_j^{ℓ c_{rj}} =
            e^{iπ \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j} =\\
          &= \cos\left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j\right) +
            i \sin\left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j\right).
    \end{split}
  \end{align}

  By continuity of \(| \cos(π ϑ) |\) in \(ϑ\), we can find
  a constant \(λ > 0\) such that \(1 - |\cos(π ϑ)| < 1/2\) whenever \(|ϑ| <
  λ\). Or put differently, \(|\cos(π ϑ)| > 1/2\).

  Let \(c_0 = \max_{r,j}(|c_{rj}|)\). Setting \(α_j := k ϑ_j\), \(β_j = 0\),
  \(N = 1\), and \(ε := λ / (2 c_0 n)\) we obtain by Kronecker's
  theorem~(\ref{thm:Kronecker}) integers \(\tilde{ℓ}, \tilde{ℓ}_j\) with
  \(\tilde{ℓ} > 0\) such that
  \[
    |\tilde{ℓ} k ϑ_j - \tilde{ℓ}_j| < \frac{λ}{2 c_0 n}
  \]
  holds for all \(j ∈ J_0\) simultaneously. But then
  \[
    |2 \tilde{ℓ} k ϑ_j - 2 \tilde{ℓ}_j| < \frac{λ}{c_0n}
  \]
  holds as well and we set \(ℓ := 2 \tilde{ℓ} k\) and \(ℓ_j := 2 \tilde{ℓ}_j\).
  This does not only implies that
  \[
    \left| \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j - \sum_{j ∈ J_0} ℓ_j c_{rj} \right| < λ
  \]
  but also by the choice of the \(ℓ_j\) that \(\sum_{j ∈ J_0} ℓ_j c_{rj} ∈ ℤ\)
  is divisible by \(2\) for all \(s_K + 1 < r ≤ n\). From
  \eqref{eq:approximation of sigma x and sigma y} we conclude that
  \[
    |σ_r(\px_{ℓb})| =
      \left| \cos\left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j\right) \right| =
      \left| \cos\left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j -
                       π \sum_{j ∈ J_0} ℓ_j c_{rj}\right) \right| > \frac{1}{2}.
  \]
  Setting \(m := ℓb\) proves the first claim as \(ℓ\) is divisible by \(k\).

  To prove the claimed bound for \(\py_h\) let \(C_r := \sum_{j ∈ J_0} c_{rj}\)
  for all \(s + 1 < r ≤ n\) and fix a constant \(C_0 ∈ ℕ\) such that \(C_0 >
  \max_r (|C_r|)\) and in the prime factorization of \(C_0\) appear at least as
  many twos as in all the prime factorizations of the \(C_r\). In other words,
  \[
    \ord_2 C_0 ≥ \ord_2 C_t, \quad \text{ for all } s + 1 < t ≤ n.
  \]

  As \(|\sin(π ϑ)|\) is uniformly continuous on the compact interval \([-1, 1]\)
  we can find for all positive \(λ_1 > 0\) a real number \(0 < λ_2 < 1/4\) such
  that \(||\sin(π ϑ)| - |\sin(π φ)|| < λ_1\) whenever \(|ϑ - φ| < λ_2\) and
  \(ϑ, φ ∈ [-1, 1]\) are satisfied. We apply Kronecker's theorem again with the
  parameters \(α_j := k ϑ_j\), \(β_j := 1/(4 C_0)\), \(N := 1\), and \(ε := λ_2
  / (2 C_0 n)\) and obtain integers \(\tilde{ℓ}, \tilde{ℓ}_j\) with \(\tilde{ℓ}
  > 0\) and the property that
  \[
    \left\vert \tilde{ℓ} k ϑ_j - \tilde{ℓ}_j - \frac{1}{4 C_0}\right\vert
     < \frac{λ_2}{2 C_0 n}
  \]
  holds for all \(j ∈ J_0\) simultaneously. We again multiply by \(2\) to obtain
  \[
  \left\vert 2 \tilde{ℓ} k ϑ_j - 2 \tilde{ℓ}_j - \frac{1}{2 C_0}\right\vert
    < \frac{λ_2}{C_0 n}
  \]
  and set \(ℓ := 2 \tilde{ℓ} k\) and \(ℓ_j := 2 \tilde{ℓ}_j\) for all \(s_K + 1
  < r ≤ n\). Hence, we can deduce that
  \[
    \left|
      \sum_{j ∈ J_0} \left( ℓ c_{rj} ϑ_j - ℓ_j c_{rj}\right) - \frac{C_r}{2 C_0}
    \right| ≤
    \left|
      \sum_{j ∈ J_0}
        \left( ℓ c_{rj} ϑ_j - ℓ_j c_{rj} - \frac{c_{rj}}{2 C_0}\right)
    \right| < λ_2
  \]
  and again that \(\sum_{j ∈ J_0}ℓ_j c_{rj}\) is divisible by \(2\) for all
  \(s_K + 1 < r ≤ n\). Set now \(λ_1 = 1/2 | \sin(π C_r / (2 C_0))|\) then we
  can use \eqref{eq:approximation of sigma x and sigma y} to obtain
  \begin{align*}
    \left\vert
      |σ_{r1}(δ) σ_r (y_{ℓb})| -
        \left| \sin\left( π \frac{C_r}{2 C_0} \right)\right|
    \right\vert &=
      \left|\left|
          \sin \left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j \right)
        \right| -
        \left\vert \sin\left( π \frac{C_r}{2 C_0} \right)\right\vert
       \right\vert=\\
      &= \left|\left| \sin \left(π \sum_{j ∈ J_0} ℓ c_{rj} ϑ_j  -
              π \sum_{j ∈ J_0}ℓ_j c_{rj}\right)
          \right|
          \left\vert \sin\left( π \frac{C_r}{2 C_0} \right)\right\vert
        \right| <\\
      &< λ_1 = \frac{1}{2} \left| \sin \left( π \frac{C_r}{2 C_0}\right)\right|
  \end{align*}
  for all \(s_K + 1 < r ≤ n\). Thus, we can conclude that \(|σ_{r1}(δ) σ_r
  (y_{ℓb})| > λ_1\).

  Note that \(\sin(π C_r / (2 C_0)) ≠ 0\) as \(C_r / (2 C_0)\) cannot be an
  integer by the choice of \(C_0\). Now set
  \[
    C :=
      \min_{r}
        \frac{\left|
          \sin \left(π \frac{C_r}{2 C_0}\right)
        \right|}{2 |σ_{r1}(δ)|}
  \]
  then \(C\) satisfies the claim.
\end{proof}

\begin{lem}\label{lem:defining e}
  Let \(K\) be a number field of degree \(n > 0\) over \(ℚ\) and let \(a ∈
  \algint\) satisfy \eqref{eq:approximations of a}. If \(\py_{eh}\) satisfies
  \cref{lem:approximations of sigma x and sigma y} for an arbitrary but fixed
  positive integer \(k ∈ ℕ \setminus \set{0}\) dividing \(h\), where \(e ≥
  |μ(K)|\) is an integer such that
  \begin{equation}\label{eq:def of e}
    |ε_1^e| > \frac{4 |δ_1|^{s_K + 1}}{C^{n - s_K - 1}}
  \end{equation}
  holds for the constant \(C\) of the same lemma, then
  \begin{thmlist}
    \item \(\py_{eh} \mid \py_{eℓ}\) implies \(h \mid ℓ\) in \(ℤ\) and

    \item \(\py_{eh}^2 \mid \py_{eℓ}\) implies \(h \py_{eh} \mid ℓ\) in
    \(\algint\).
  \end{thmlist}
\end{lem}
\begin{proof}
  Note that such an integer \(e\) must exist as \(|ε_1| > 1\) by
  \cref{lem:approximation of epsilon with a}. Let now \(q ∈ ℕ\) be such that
  \(0 < r < h\). As before let \(L := K[δ]\). Considering the field norm \(N_{L
  / ℚ}\) of \(\py_{eq}\) we use \cref{lem:real part of epsilon} to obtain
  \begin{align*}
    | N_{L / ℚ} (\py_{er}) | &=
        \prod_{i = 1}^n
          \prod_{j = 1}^2
            \left| σ_{ij} \left( \frac{ε^{er} - ε^{-er}}{2δ}\right) \right| ≤\\
      &≤ \prod_{i = 1}^{s_K + 1}
        \frac{|ε_i^{er} - ε_i^{-er}| |ε_i^{-er} - ε_i^{er}|}{4 |δ_i|^2}
        \prod_{i = s_K + 2}^n \frac{1}{|δ_i|^2}\\
      &≤ \frac{4 |ε_1|^{2er(s_K + 1)}}{4^{s_K + 1} |N_{K/ℚ}(a^2 - 1)|} <
      \frac{|ε_1|^{2er (s_K + 1)}}{4^{s_K}},
  \end{align*}
  where the approximations follow completely analogously as in the proof of
  \cref{pro:epsilon essentially generaltes G}. As \(\py_{er}\) is in \(\algint\)
  we deduce that
  \[
    |N_{K / ℚ} (\py_{er})| < \frac{|ε_1|^{er (s_K + 1)}}{2^{s_K}}.
  \]

  On the other hand, by our assumption on \(|σ_i(\py_{eh})|\) we know that
  \begin{align*}
    |N_{K / ℚ} (\py_{eh})| &= \prod_{i = 1}^n | σ_i(\py_{eh}) | ≥
        C^{n - s_K - 1} \prod_{i = 1}^{s + 1} |σ_i(\py_{eh}) | =\\
      &= C^{n - s_K - 1} \prod_{i = 1}^{s_K + 1} \frac{|ε_i^{eh} -
           ε_i^{-eh}|}{2 |δ_i|} ≥
        C^{n - s_K - 1}
        \left( \frac{|ε_1|^{eh} - 1}{2 |δ_1|} \right)^{s_K + 1} >\\
      &> C^{n - s_K - 1}
        \frac{|ε_1|^{eh (s_K + 1)}}{2^{s_K + 2} |δ_1|^{s_K + 1}},
  \end{align*}
  where the second inequality follows from \(|ε_1^{-1}| ≤ 1\). Using our
  assumption on \(e\), it follows that
  \begin{equation}\label{eq:norm of x eh and x er}
    |N_{K / ℚ} (\py_{eh})| > | N_{L / ℚ}(\py_{er}) |.
  \end{equation}

  Let \(\py_{eh} \mid \py_{eℓ}\) and  set \(ℓ = t h + r\) for \(t, r ∈ ℕ\) with
  \(0 ≤ r < h\). Assume to reach a contradiction that \(r > 0\), then
  \[
    \py_{eℓ} = \py_{eth + er} \overset{\text{\cref{lem:addition formulas}}}{=}
    \py_{eth}\px_{er} + \px_{eth} \py_{er}.
  \]
  By \cref{lem:y m divides y mk} we know that \(\py_{eh} \mid \py_{eth}\) and
  consequently \(\py_{eh} \mid \px_{eth} \py_{er}\) in \(\algint\). But by
  \cref{lem:x m and y m are relative prime} the principal ideals \((\px_{eth})\)
  and \((\py_{eth})\) are relative prime. Now \cref{lem:y m divides y mk}
  implies that \((\px_{eth})\) and \((\py_{eh})\) are relative prime as well.
  And therefore \(y_{eh} \mid y_{er}\), contradicting \eqref{eq:norm of x eh and
  x er}. Consequently, \(r = 0\) and \(h \mid ℓ\) in \(ℤ\).

  To see the second divisibility condition we assume \(\py_{eh}^2 \mid
  \py_{eℓ}\) in \(\algint\). Then by the first part of the lemma, we know that
  there exists an integer \(t\) such that \(ℓ = th\). Using the binomial formula
  we obtain
  \begin{align*}
    \px_{eth} + δ\py_{eth} &= (ε^{eh})^t = (\px_{eh} + δ \py_{eh})^t =\\
      &= \sum_{\substack{0 ≤ i ≤ t\\2 \text{ even}}}
        \binom{t}{i} \px_{eh}^{t - i} δ^i \py_{eh}^i +
      δ \sum_{\substack{0 ≤ i ≤ t\\2 \text{ odd}}}
        \binom{t}{i} \px_{eh}^{t - i} δ^{i - 1} \py_{eh}^i
  \end{align*}
  and, since \((\px_{eh})\)  and \((\py_{eh})\) are relative prime, we can
  conclude that
  \[
    0 \equiv \py_{eth} \equiv t \px_{eh}^{t - 1} \py_{eh} \equiv t \py_{eh}
    \mod (\py_{eh}^2).
  \]
  It follows that \(\py_{eh} \mid t\) in \(\algint\) and therefore \(h \py_{eh}
  \mid ℓ\).
\end{proof}

As a next step we prove a similar result for \(\px_m\).

\begin{lem}
  Let \(K\) be a number field of degree \(n > 0\) over \(ℚ\) and let \(a ∈
  \algint\) satisfy \eqref{eq:approximations of a}. If \(\px_{m}\) satisfies
  \[
    |σ_i(\px_m)| > ½
  \]
  for \(s_K + 1 < i ≤ n\) then for all integers \(ℓ, j  ∈ ℤ\) and some sign \(ς
  ∈ \set{-1, 1}\) we have that \(\px_ℓ \equiv \px_j ς \mod (\px_m)\) in
  \(\algint\) implies \(ℓ \equiv ± j \mod m\) in \(ℤ\).
\end{lem}
\begin{proof}
  Set \(ℓ = 2 m ℓ_1 + r_1\) as well as \(j = 2 m j_1 + r_2\) with \(-m < r_1,
  r_2 ≤ m\). Without loss of generality we may assume that \(0 ≤ r_1, r_2 ≤ m\)
  holds, since we have
  \[
    \px_ℓ = \px_{2 m ℓ_1 ± r_1} \equiv -\px_{r_1} \mod (\px_m)
    \quad \text{and} \quad
    \px_j = \px_{2 m j_1 ± r_2} \equiv -\px_{r_2} \mod (\px_m)
  \]
  by \cref{lem:congruence x_2m+k}. Thus, we can deduce that \(\px_{r_1} \equiv
  \px_{r_2} ς \mod (\px_m)\). We will prove that \(\px_{r_1} = \px_{r_2} ς\) and
  will deduce \(r_1 = r_2 ς\). Assume otherwise that \(r_1 ≠ r_2\) and
  \(\px_{r_1} ≠ \px_{r_2} ς\) then from the congruence it follows that
  \begin{equation}\label{eq:approx of x r1  x r2 and x m}
    |N_{K/ℚ} (\px_m)| ≤ |N_{K/ℚ} (\px_{r_1} - \px_{r_2} ς)|.
  \end{equation}

  To reach a contradiction we assume without loss of generality that \(r_1 ≤
  r_2\) and appeal to \cref{lem:real part of epsilon} to express \(\px_m,
  \px_{r_1}\) and \(\px_{r_2}\) as the ‘real part’ of a power of \(ε\). Now
  similarly as in the proof of \cref{lem:defining e}, we have that
  \begin{equation}\label{eq:norm of p x}
    \begin{split}
    |N_{K/ℚ}(\px_m)| &=
      \prod_{i = 1}^{s_K + 1} |σ_i(\px_m)| \prod_{i = s_K + 2}^n |σ_i(\px_m)|≥
        \frac{1}{2^{n - s_K - 1}} |σ_1(\px_m)|^{s_K + 1}=\\
      &= \frac{1}{2^{n - s_K - 1}}
            \left| \frac{ε_1^m + ε_1^{-m}}{2} \right|^{s_K + 1} ≥
          \frac{(|ε_1|^m - 1)^{s_K + 1}}{2^n}
    \end{split}
  \end{equation}
  Again the last inequality follows from the triangular inequality and the fact
  that \(|ε_1^{-1}| ≤ 1\). To estimate the norm of \(\px_{r_1} - \px_{r_2} ς\)
  we note that by \cref{lem:properties of sigma epsilon} we know for all \(s_K +
  1 < i ≤ n\) that
  \[
    |σ_i(\px_{r_1}) - σ_i(\px_{r_2} ς)| ≤
    \frac{|ε_i^{r_1} - ε_i^{-r_1}| + |ς| |ε_i^{r_2} - ε_i^{-r_2}|}{2} ≤
    \frac{|ε_i|^{r_1} + |ε_i|^{-r_1} + |ε_i|^{r_2} + |ε_i|^{-r_2}}{2} = 2.
  \]
  Thus, we can conclude that
  \begin{equation}
    \begin{split}\label{eq:norm of x r1 plus x r2}
    |N_{K/ℚ}(\px_{r_1} - \px_{r_2} ς)| &=
      \prod_{i = 1}^n |σ_i(\px_{r_1} - σ_i(\px_{r_2} ς)| ≤
      2^{n - s_K - 1} |σ_i(\px_{r_1} - σ_i(\px_{r_2} ς)|^{s_K + 1} ≤\\
    &≤   2^{n - s_K - 1} \left(
      \frac{|ε_1|^{r_1} + |ε_1|^{-r_1} + |ε_1|^{r_2} + |ε_1|^{-r_2}}{2}
    \right)^{s_K + 1} ≤\\
    &≤ 2^{n - s_K - 1}(|ε_1|^{r_2} + 1)^{s_K + 1}.
    \end{split}
  \end{equation}

  We know by \cref{lem:approximation of epsilon with a} that \(|ε_1| > 1\). So
  \(|ε_1|^{r_2} + 1 < 2 |ε_1|^{r_2}\) and by \cref{lem:approximation of epsilon
  with a} we have that
  \[
    |ε_1|^m - 1 > |a|^m - 1 > ½ (|a|^m + 1) > ½ |ε_1|^m.
  \]
  Now notice that \(s_K ≤ 1\) and thus we can deduce from \eqref{eq:norm of p
  x} and \eqref{eq:norm of x r1 plus x r2} that
  \begin{align}\label{eq:norm of x m and x r1 plus x r2 1}
    |N_{K/ℚ}(\px_m)| &≥ \frac{|ε_1|^{m (s_K + 1)}}{2^{n + s_K + 1}} ≥
    \frac{|ε_1|^{m (s_K + 1)}}{2^{n + 2}}\\
    \intertext{and}\label{eq:norm of x m and x r1 plus x r2 2}
    |N_{K/ℚ}(\px_{r_1} - \px_{r_2} ς)| &≤ 2^{n} |ε_1|^{r_2 (s_K + 1)}.
  \end{align}

  We will now distinguish to cases. Either \(r_2 < m\) then we have that
  \[
    2^{2n + 2} < |a|^{s_K + 1} < |ε_1|^{s_K + 1} ≤
    |ε_1|^{(m - r_2)(s_K + 1)},
  \]
  which together with the inequalities in \eqref{eq:norm of x m and x r1 plus x
  r2 1} and \eqref{eq:norm of x m and x r1 plus x r2 2} implies
  \[
    |N_{K/ℚ} (\px_m)| > |N_{K/ℚ} (\px_{r_1} - \px_{r_2} ς)|.
  \]
  Thus, we have reached a contradiction with \eqref{eq:approx of x r1  x r2 and
  x m} and we must assume that \(r_2 = m\) holds. But this implies that
  \(\px_m\) actually divides \(\px_{r_1}\), yielding
  \[
    |N_{K/ℚ} (\px_m)| ≤ |N_{K/ℚ} (\px_{r_1})|.
  \]
  As for the norm of \(\px_{r_1}\) we find that
  \begin{align*}
    |N_{K/ℚ} (\px_{r_1})| &=
         |σ_1(\px_{r_1})|^{s_K + 1} \prod_{i = s_K + 2}^n |σ_i(\px_{r_1})| ≤\\
      &≤ |σ_1(\px_{r_1})|^{s_K + 1} \prod_{i = s_K + 2}^n
                \frac{|ε_i|^{r_1} + |ε_i|^{-r_1}}{2} = |σ_1(\px_{r_1})|^2 ≤\\
      &≤ \left(\frac{|ε_1^{r_1} + ε_1^{r-1}|}{2}\right)^{s_K + 1} ≤\\
      &≤ \left(\frac{|ε_1|^{r_1} + 1}{2}\right)^{s_K + 1} ≤
         |ε_1|^{r_1 (s_K + 1)}
  \end{align*}
  holds. Remember that we are assuming that \(r_1 ≠ r_2\) and we have already
  shown \(r_2 = m\). Thus, we can conclude that \(2^{n + 2} < |ε_1|^{m - r_1}\).
  But then the inequality above implies together with \eqref{eq:norm of x m and
  x r1 plus x r2 1} that
  \[
    |N_{K/ℚ} (\px_m)| > |N_{K/ℚ} (\px_{r_1})|,
  \]
  which is again an contradiction.

  As a consequence, our assumption that both \(r_1 ≠ r_2\) and \(\px_{r_1} ≠
  \px_{r_2} ς\) are true can not hold. So the only thing left to check is that
  \(\px_{r_1} = \px_{r_2} ς\) implies \(r_1 = ± r_2\), which yields the desired
  congruence of rational integers. We know that \(\px_{r_1} = \px_{r_2} ς\)
  implies \(ε^{r_1} + ε^{-r_1} = (ε^{r_2} + ε^{-r_2}) ς\). If \(ς = 1\) we find
  that this is equivalent to
  \[
    0 = ε^{r_1} (ε^{r_1} + ε^{-r_1} - ε^{r_2} - ε^{-r_2}) =
      ε^{2 r_1} + 1 - ε^{r_1 + r_2} - ε^{r_1 - r_2} =
      (ε^{r_1 + r_2} - 1) (ε^{r_1 - r_2} - 1).
  \]
  Hence, \(r_1 = ± r_2\) as claimed. If on the other hand, \(ς = -1\) holds we
  find
  \[
  0 = -ε^{r_2} (ε^{r_1} + ε^{-r_1} - ε^{r_2} - ε^{-r_2}) =
    -ε^{r_2 + r_1} -ε^{r_2 - r_1} + ε^{2 r_2} + 1 =
    (ε^{r_2 + r_1} - 1) (ε^{r_2 - r_1} - 1),
  \]
  yielding \(r_1 = ± r_2\).
\end{proof}

\begin{lem}
  Let \(K\) be a number field of degree \(n\) over \(ℚ\) and let \(a ∈ \algint\)
  satisfy \eqref{eq:approximations of a}. Then for all positive \(m ∈ ℕ
  \setminus \set{0}\) there exists an algebraic integer \(b\) such that
  \begin{thmlist}
    \item \(b \equiv 1 \mod (\py_m(a))\),

    \item \(b \equiv a \mod (\px_m(a))\), and

    \item \(b\) satisfies the approximations of the embeddings of \(a\) in
    \eqref{eq:approximations of a}.
  \end{thmlist}
\end{lem}
\begin{proof}
  Set
  \[
    b :=
    \left(
      \px_m(a)^2 + \py_m(a)^2 (a^2 - 1)
    \right)^{2s}
    \left(
      \px_m(a)^4 + a \left(1 - \px_m(a)^2\right)^2
    \right)
  \]
  for some positive integer \(s\), whose value will be determined later. Note
  that since \(\px_m(a)\) and \(\py_m(a)\) solve Pell's equation, we have
  \[
    \px_m(a)^2 - (a^2 - 1)\py_m(a)^2 = 1,
  \]
  or put differently \((a^2 - 1) \py_m(a)^2 \equiv -1 \mod (\px_m(a))\). Thus,
  condition~(ii) is satisfied. As for condition~(i), we note that by the same
  argument \(\px_m(a)^2 \equiv 1 \mod (\py_m(a))\) holds.

  To prove the last claim note that for all positive \(m\), we have
  \[
    |σ_i(\px_m(a))| = \left| \frac{ε_i(a)^m + ε_i(a)^{-m}}{2} \right| ≤
    \frac{|ε_i(a)|^m + |ε_i(a)|^{-m}}{2} = 1
  \]
  for all \(s_K + 1 < i ≤ n\). The only way equality can be reached in the
  inequality above is if \(|ε_i(a)^m + ε_i(a)^{-m}| = |ε_i(a)|^m +
  |ε_i(a)|^{-m}\). But this can only happen, if there arguments coincide, which
  implies that both \(ε_i(a)^{m}\) and \(ε_i(a)^{-m}\) are real numbers with
  complex modulus \(1\). Hence, \(ε_i(a)^{2m} = 1\) and \(ε(a)\) would be a
  \(2m\)-th root of unity, contradicting \cref{lem:epsilon is not a root of
  unity}. We conclude that the approximation of the modulus \(|σ_i(\px_m(a))| <
  1\) holds for all \(s_K + 1 < i ≤ n\). But since
  \[
    |N_{K/ℚ}(\px_m(a))| =
      |σ_1(\px_m(a))|^{s_K + 1} \prod_{i = s_K + 2}^n |σ_i(\px_m(a))|
  \]
  is a positive integer we must also have \(|σ_1(\px_m(a))| > 1\).

  As for the embeddings of \(b\) we have
  \[
    σ_i(b) =
    \left(
      σ_i(\px_m(a))^2 + σ_i(\py_m(a))^2 (a_i^2 - 1)
    \right)^{2s}
    \left(
      σ_i(\px_m(a))^4 + a_i \left(1 - σ_i(\px_m(a))^2\right)^2
    \right)
  \]
  where \(|a_i| > 1\) for all \(1 ≤ i ≤ s_K + 1\) and \(|a_i| < 1\) for all
  \(s_K + 1 < i ≤ n\) by \eqref{eq:approximations of a}. Let us first consider
  the case for \(1 ≤ i ≤ s_K + 1\). Then
  \[
  \left|
    σ_i(\px_m(a))^2 + σ_i(\py_m(a))^2 (a_i^2 - 1)
  \right| = |2 σ_i(\px_m(a))^2 - 1| ≥ 2 |σ_i(\px_m(a))|^2 - 1 > 1
  \]
  holds and thus \(|σ_i(b)|\) is strictly increasing in \(s\). On the other
  hand, if \(s_K + 1 < i ≤ n\) we note that \(σ_i(\px_m)\) is a real number as
  \(σ_i : K → ℝ\) is a real embedding and conclude that both
  \begin{align*}
    σ_i(\px_m(a))^2 - σ_i(\py_m(a))^2 (1 - a_i^2) &< σ_i(\px_m(a))^2 < 1 \\
    \intertext{as well as}
    σ_i(\px_m(a))^2 - σ_i(\py_m(a))^2 (1 - a_i^2) &= 2 σ_i(\px_m(a))^2 - 1 > -1
  \end{align*}
  hold. As a consequence, the moduls \(|σ_i(b)|\) is strictly decreasing in
  \(s\). Hence, we can arrange for \(|σ_i(b)| > 2^{2(n + 1)}\) and \(|σ_j(b)| <
  1/2\) to hold (\(1 ≤ i ≤ s_K + 1 < j ≤ n\)), as claimed.
\end{proof}

Before we can present a Diophantine representation of the rational integers over
\(K\) we need two more auxiliary results. I present the proofs of Lemma~5.2.1
and Corollary~5.2.2 of Shlapentokh's book~\cite{Shlapentokh2007} but a similar
result can be found in Lemma~8 of the paper~\cite{Denef1980}.
\begin{lem}
  Let \(K\) be a number field of degree \(n\) over rationals \(ℚ\). Let \(α, β ∈
  \algint \setminus \set{0}\) and assume that for \(0 ≤ i ≤ n\) we have that
  \(ℓ_i − α\) divides \(β\) in the ring of integers \(\algint\) for some
  distinct non-negative integers \(0 = ℓ_0, \seq{ℓ}\). Then there exists a
  constant \(C > 0\), depending solely on the integers \(n, \seq{ℓ}\), such that
  the absolute values of all the coefficients of the characteristic polynomial
  \(μ_{ℚ, α}\) of \(α\) over \(ℚ\) are bound from above by \(C|N_{K/ℚ} (β)|\).
\end{lem}
\begin{proof}
  Since \(ℓ_i - α\) divides \(β\), we know that there exists a non-zero rational
  integer \(d_i\) such that
  \[
    N_{K/ℚ}(ℓ_i - α) d_i = N_{K/ℚ}(β).
  \]
  We set \(c_i := 1 / d_i\) and note that \(|c_i| < 1\) for all \(0 ≤ i ≤ n\).
  On the other hand, notice that
  \[
    N_{K/ℚ}(ℓ_i - α) = \prod_{j = 1}^n (ℓ_i - σ_i(α)) = μ_{ℚ, α}(ℓ_i),
  \]
  where \(\seq{σ}\) denote the embeddings of \(K\) into \(ℂ\) and \(μ_{ℚ, α}\)
  is the minimal polynomial of \(α\) over \(ℚ\). From these two observations we
  obtain that \(μ_{ℚ, α}(ℓ_i) = c_i N_{K/ℚ}(β)\). Let
  \[
    μ_{ℚ, α}(X) = X^n + a_{n - 1} X^{n - 1} + … + a_1 X + a_0,
  \]
  then we can view these identities as a linear system of \(n + 1\) equations in
  the variables \(a_0, \seq{a} = 1\). Written in matrix form the system looks
  like
  \[
    \underbrace{
      \begin{pmatrix}
        1 & … & 0                 & 0     \\
        1 & … & ℓ_1^{n - 1}       & ℓ_1^n \\
        \vdots & & \vdots & \vdots  \\
        1 & … & ℓ_{n - 1}^{n - 1} & ℓ_{n - 1}^n \\
        1 & … & ℓ_1^{n}           & ℓ_1^n \\
      \end{pmatrix}
    }_{:= A}
    \begin{pmatrix}
      a_0 \\ a_1 \\ \vdots \\ a_{n - 1} \\ a_n
    \end{pmatrix}
    =
    \underbrace{
      \begin{pmatrix}
        c_0 N_{K/ℚ}(β) \\
        c_1 N_{K/ℚ}(β) \\
        \vdots \\
        c_{n - 1} N_{K/ℚ}(β) \\
        c_n N_{K/ℚ}(β) \\
      \end{pmatrix}
    }_{:= b}
  \]
  Note that matrix \(A\) is of Vandermonde-shape and thus has non-zero
  determinant. Hence, we can use Cramer's rule to solve the system and obtain
  \[
    a_i =
      {\det A}^{- 1} \;
      \det
      \begin{pmatrix}
        1 & … & c_0 N_{K/ℚ}(β) & … & 0 \\
        1 & … & c_1 N_{K/ℚ}(β) & … & ℓ_1^n \\
        \vdots & & \vdots & & \vdots \\
        1 & … & c_{n - 1} N_{K/ℚ}(β) & … & ℓ_{n - 1}^n \\
        1 & … & c_n N_{K/ℚ}(β) & … & ℓ_n^n \\
      \end{pmatrix},
  \]
  where in \(A_i\) the \(i\)-th column of matrix \(A\) is replaced by \(b\). But
  this implies
  \[
    a_i =
      {\det A}^{- 1} \; N_{K/ℚ}(β)
      \det
      \underbrace{
        \begin{pmatrix}
          1 & … & c_0  & … & 0 \\
          1 & … & c_1  & … & ℓ_1^n \\
          \vdots & & \vdots & & \vdots \\
          1 & … & c_{n - 1}  & … & ℓ_{n - 1}^n \\
          1 & … & c_n  & … & ℓ_n^n \\
        \end{pmatrix}
      }_{:= A_i},
  \]
  and setting \(C := \max_i|{\det A}^{-1} \det A_i|\) yields the claim.
\end{proof}

\begin{cor}
  Let \(K\) be a number field of degree \(n\) over \(ℚ\). Fix two non-zero
  algebraic integers \(α, β ∈ K \setminus \set{0}\) and assume that there are
  pair-wise distinct non-negative integers \(0 = ℓ_0, \seq{ℓ}\) with the
  property that \(ℓ_i - α\) divides \(β\) in \(\algint\) for \(0 ≤ i ≤ n\). Then
  there exists a constant \(C ∈ ℚ\), such that for all embeddings \(σ: K → ℂ\)
  we have that \(|σ(α)| ≤ C |N_{K/ℚ}(β)|\). If additionally \(β\) is not a unit
  then there exist a non-negative integer \(c ∈ ℕ\) such that \(|σ(α)| ≤
  |N_{K/ℚ}(β)|^c\).
\end{cor}
\begin{proof}
  Let
  \[
    μ_{ℚ, α}(X) = X^n + a_{n - 1} X^{n - 1} + … + a_1 X + a_0.
  \]
   Then since \(σ(α)\) is a root of \(μ_{ℚ, α}\) as well, we know that
  \[
    σ(α)^n = - a_{n - 1} {σ(a)}^{n - 1} - … - a_1 σ(a) - a_0.
  \]
  By the previous lemma there exists a constant \(\tilde{C}\) such additionally
  that \(|a_i| ≤ \tilde{C} |N_{K/ℚ}(β)|\). If now \(|σ(α)| > 1\) then
  \[
    |σ(α)| ≤ |a_{n - 1}| + … + |a_1| + |a_0| ≤ n \tilde{C} |N_{K/ℚ}(β)|.
  \]
  Setting \(C := \max(1, n \tilde{C})\) yields the first claim. If addtionally
  \(β\) is not a unit then the absolute value of its norm is strictly greater
  than one. Hence, there exists a non-negative integer \(c\) such that
  \(\tilde{C} ≤ |N_{K/ℚ}(β)|^{c - 1}\).
\end{proof}

\begin{thm}
  Let \(K\) be a number field of degree \(n > 0\) over \(ℚ\) and let \(a ∈
  \algint\) satisfy \eqref{eq:approximations of a}. Let \(\seq{σ}\) be all
  embeddings of \(K\) into \(ℂ\), where we demand that \(σ_i\) is a non-real
  embedding if and only if \(i ≤ 2 s_K\). Furthermore, let \(C\) be the bound
  defined in \cref{lem:approximations of sigma x and sigma y} and \(e\) defined
  as in \eqref{eq:def of e}. Then the set \(S\) defined by the following
  relations is Diophantine over \(\algint\) and satisfies \(ℕ ⊂ S ⊂ ℤ\).
  \begin{align}
    ξ ∈ S \quad &⇔ \quad
      ∃ x, y, w, z, u, v, s, t, x', y', w', z', u', v', s', t', b, f ∈ \algint:
      \nonumber \\
      \label{eq:seq 1}
      & x^2 - (a^2 - 1) y^2 = 1 \\
      \label{eq:seq 2}
      & w'^2 - (a^2 - 1) z'^2 = 1 \\
      \label{eq:seq 2.1}
      & w - δ z = {(w' - δ z')}^e \\
      \label{eq:seq 3}
      & u^2 - (a^2 - 1) v^2 = 1 \\
      \label{eq:seq 4}
      & s^2 = (b^2 - 1) y^2 = 1 \\
      \label{eq:approx of embeddings 1}
      & 0 < σ_i(b) < 2^{-16} \quad \text{for all } s_K + 1 < i ≤ n \\
      \label{eq:approx of embeddings 2}
      & |σ_i(z)| ≥ C, \quad |σ_i(u)| ≥ ½ \quad \text{for all } s_K + 1 < i ≤ n\\
      \label{eq:v is non zero}
      & v ≠ 0 \\
      \label{eq:z 2 divides v}
      & z^2 \mid v \\
      \label{eq:cong 1}
      & b \equiv 1 \mod (z), \quad b \equiv a \mod (u) \\
      \label{eq:cong 2}
      & s \equiv x \mod (u) \\
      \label{eq:cong 3}
      & t \equiv ξ \mod (z) \\
      \label{eq:divisibilty of f}
      & \prod_{i=0}^n (i - ξ)(i - x) \mid f \quad
        \text{where } f ≠ 0 \text{ and } (2^n f^{cn}) \mid z
  \end{align}
\end{thm}
\begin{proof}
  Note that the set \(S\) defined by the relations above is indeed Diophantine
  since \eqref{eq:approx of embeddings 1} as well as \eqref{eq:approx of
  embeddings 2} can be rewritten in a Diophantine form by
  \cref{lem:approximations of embeddings are Diophantine} and \eqref{eq:v is non
  zero} as well as \eqref{eq:divisibilty of f} are Diophantine by \cref{ex:being
  non zero is Diophantine}. Finally, the conjunction of all of these Diophantine
  relations is Diophantine by \cref{lem:intersections and unions}.

  First suppose that the relations above have a common solution \(ξ\). We need
  to show that \(ξ\) is a rational integer. To see this I first claim that \(b\)
  satisfies \eqref{eq:approximations of a}. Indeed, the part for the embeddings
  \(σ_i(b)\) with \(s_K + 1 < i ≤ n\) are guaranteed by \eqref{eq:approx of
  embeddings 1}. For the embeddings \(σ_i(b)\) with \(1 ≤ i ≤ s_K + 1\) we note
  that since \(b\) is an algebraic integer, its norm \(N_{K/ℚ}(b)\) must have an
  absolute value of at least one. Thus, we have
  \[
    1 ≤ |N_{K/ℚ}(b)| = |σ_1(b)|^{s_K + 1} \prod_{i = s_K + 2}^n |σ_i(b)| ≤
      |σ_1(b)|^{s_K + 1} 2^{-16 (n - s_K + 1)},
  \]
  which implies
  \[
    |σ_1(b)| ≥ 2^{16 \frac{n - s_K + 1}{s_K + 1}}.
  \]
  Now if \(s_K = 0\), then \(n ≥ 2\) and since \(16 (n - 1) > 2 (n + 1)\) the
  claim holds. If on the other hand \(s_K = 1\), then we have demanded that \(n
  ≥ 3\) holds and again since \(8 (n - 2) ≥ 2(n + 1)\) the claim holds true.

  Now \eqref{eq:seq 1}, \eqref{eq:seq 2}, \eqref{eq:seq 3}, and \eqref{eq:seq 4}
  imply by
\end{proof}

\begin{cor}\label{cor:ZZ is Diophantine over O K}
  Let \(K\) be a totally real number field or a number field with exactly one
  pair of non-real embeddings and at least one real embedding. Then \(ℤ\) is
  Diophantine over \(\algint\).
\end{cor}
\begin{proof}
  By the theorem ther exists a Diophantine set \(S ⊂ \algint\) with the
  property \(ℕ ⊂ S ⊂ ℤ\). Thus, \(ℤ\) can be defined in a Diophantine way as
  follows
  \[
    α ∈ ℤ \quad ⇔ \quad
    ∃ β_1, β_2 ∈ \algint : (α = β_1 β_2) ∧ (β_1 ∈ S) ∧ (β_2 - 1)(β_2 + 1) = 0
  \]
\end{proof}

%
% \begin{lem}\label{lem:rank of S is greater 0}
%   Let \(K\) be a totally real number field and \(a ∈ \algint\) satisfies \(δ =
%   δ(a) \not\in \algint\) as well as~\eqref{eq:embeddings of a into reals v1}.
%   Then \(ε(a) = ε\) is torsion free i.e.\ there is a group isomorphism \(⟨ε⟩ \cong
%   ℤ\).
% \end{lem}
% \begin{proof}
%   Assume otherwise that \(ε^m = 1\) for some positive integer \(m\) i.e. \(ε\) is an
%   \(m\)-th root of unity. As we have identified \(L\) with a subset of \(ℝ\), this
%   leaves \(±1\) as values for \(ε = 1 + δ\). This is impossible as \(δ \not\in
%   \algint\).
% \end{proof}
%
% As a consequence, of \cref{thm:Dirichlet} we find that
% \[
%   1 ≤ \rk S ≤ \rk U_L - \rk U_K ≤ (n + 1) - n = 1.
% \]
% In other words, we can write every \(η\) in \(S\) as a product \(ζ ε_0^k\), where \(ζ ∈ U_L\) is a root of unity and \(ε_0\)
