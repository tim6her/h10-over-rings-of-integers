% !TeX encoding = UTF-8
% !TeX TS-program = xelatex
% !TeX spellcheck = en_GB
% !TeX root = ../Herbstrith-H10_over_AI.tex

I closely follow the papers of \textcite{Denef1980} and \textcite{Pheidas1988},
whose structure in term heavily depends on the article
\citetitle{Davis1973} by \textcite{Davis1973}. This way, one can prove the
undecidability of Hilbert's tenth problem over rings of algebraic integers in
totally real number fields and number fields with one pair of non-real
embeddings in one go. Compare this approach to Sections 6.3 and 7.2 of the
study~\cite{Shlapentokh2007} by Shlapentokh.

\subsection{Finitely many easy lemmas}

We start by defining two sequences, that satisfy Pell's equation stated below.

\begin{equation} \label{eq:Pell}
    x^2 - d y^2 = 1
\end{equation}

Using modified versions of the techniques presented
by~\textcite{Matijasevic1970}, it will be shown that the index \(m\) can be
obtained in a Diophantine way from \(\py_m(a)\) for certain subsequences of the
sequences defined below.

\begin{defin}
  Let \(K\) be an algebraic number field, \(\algint\) its ring of algebraic integers
  and fix \(a ∈ \algint\). One defines \(δ(a) = \sqrt{a^2 - 1}\) and \(ε(a) = a +
  δ(a)\). If \(δ(a) \not\in K\) one defines \(\px_m(a), \py_m(a) ∈ \algint\) for \(m ∈ ℕ\)
  by
  \[
    \px_m(a) + δ(a) \py_m(a) = {(ε(a))}^m.
  \]
\end{defin}

This definition includes the case \(K = ℚ\) with \(\algint = ℤ\) of~\cite{Davis1973}. However, I am using the slightly modified notation of~\cite{Denef1980,Pheidas1988}.

As \(δ(a)\) is a root of the monic quadratic polynomial
\[
  X^2 - a^2 + 1 ∈ \algint {[X]}
\]
the extension \(K[δ(a)] / K\) is quadratic and \(δ(a) ∈ \algint[{K[δ(a)]}]\). The
sequences \(\px_m(a)\) and \(\py_m(a)\) are well defined for each \(m ∈ ℕ\) as they
correspond to the coefficients of \({(ε(a))}^m\) in \(K[δ(a)]/K\) with respect to the
basis \(\lbrace 1, δ(a)\rbrace\). If the reference is clear, I will omit the
dependency on \(a\) writing \(δ, ε, \px_m\) and \(\py_m\).
% QUESTION
\todo{Why does every number field contain such an element \(a\)?}
In the following the number field \(K[δ(a)]\) will denoted by \(L\).

\begin{rem}
  As \(L/K\) has degree two, there is exactly one pair of field
  automorphisms\footnote{A field extension of degree two is necessarily normal.}
  on \(L\) preserving \(K\) point-wise, namely \(σ_1^{K}(α + δβ) = α + δβ\) and \(σ_2^K(α
  + δβ) = α - δβ\) for \(α, β ∈ \algint\). The latter will be denoted by
  \(\overline{η} = σ_2^K(η)\) to emphasise the analogy of complex conjugation.
\end{rem}

Let me now collect some properties of these sequences. The proofs are
generalised versions of the ones given in~\cite{Davis1973}.

\begin{lem}
  Let \(K\) be an algebraic number field and \(a ∈ \algint\) such that \(δ(a) \not\in K\). Then
  \begin{thmlist}
    \item\label{lem:epsilon is unit}
    \(ε\) is a unit in \(\algint[K(δ(a))]\), its inverse is given by \(ε^{-1} = a - δ = \overline{ε}\), and
    \item \(\px_m, \py_m\) satisfy Pell's equation~\eqref{eq:Pell} for all \(m ∈ ℕ\), using \(d = {δ(a)}^2\) as parameter.
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item We have \(ε \; (a - δ) = (a + δ) (a - δ) = a^2 - δ^2 = 1\) as desired.
    \item One uses induction on \(m\). If \(m = 0\), the pair \(\px_0 = 1\) and \(\py_0 =
    0\) yields a trivial solution to equation~\eqref{eq:Pell}. Let the claim be
    proven for all pairs \(\px_n, \py_n\) with \(n ≤ m\). Then rewriting the definition
    of \(\px_{m + 1}, \py_{m + 1}\) one obtains
    \[
      \px_{m + 1} + δ \py_{m + 1} = ε^{m + 1} = (\px_m + δ \py_m)ε.
    \]
    Applying the automorphism \(\overline \cdot\) implies
    \[
      \overline{\px_{m + 1} + δ \py_{m + 1}} = \px_{m + 1} - δ \py_{m + 1} = (\px_m - δ \py_m) ε^{-1}
    \]
    and multiplication of both equations yields
    \[
      \px_{m + 1}^2 - d \py_{m + 1}^2 = \overline{\px_{m + 1} + δ \py_{m + 1}} (\px_{m + 1} - δ \py_{m + 1}) = 1
    \]
    as claimed.
  \end{plist}
\end{proof}

The defining equation
\[
  \px_m + δ \py_m = ε^m = {(\px_1 + δ \py_1)}^m
\]
can be seen as an analogue of the trigonometric identity
\[
  \cos m + i \sin m = e^{im} = {(\cos 1 + i \sin 1)}^m,
\]
where \(\px_m\) plays the role of \(\cos m\), \(\py_m\) the one of \(\sin m\), and \(i\) is replaced by \(δ\). In this view Pell's equation~\eqref{eq:Pell} is the analogue of the Pythagorean identity
\[
  {\cos (m)}^2 + {\sin (m)}^2 = 1.
\]

The next lemma proves the identities corresponding to \(\cos m = \Re e^m\), \(\sin
m = \Im e^m\), and the addition formulas.

\begin{lem}
  Let \(K\) be an algebraic number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\). Then for all \(m, k ∈ ℕ\) one has
  \begin{thmlist}
    \item\label{lem:real part of epsilon}
    \(\px_m = (ε^m + ε^{-m}) / 2\) and \(\py_m = (ε^m - ε^{-m}) / (2 δ)\), as well as,
    \item\label{lem:addition formulas}
    \(\px_{m ± k} = \px_m \px_k ± δ^2 \py_m \py_k\), and
    \(\py_{m ± k} = \px_k \py_m ± \px_m \py_k\).
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item In \cref{lem:epsilon is unit} we have seen that \(ε^{-1} =
    \overline{ε}\) and therefore \(ε^{-m} = {\left(\overline{ε}\right)}^m\). Observe that for arbitrary \(α, β ∈ \algint\) we have
    \[
      α + β y + \overline{α + δ β} = 2α \quad \text{and} \quad
      α + β y - \overline{α - δ β} = 2δ β.
    \]
    Now, setting \(α + δ β = ε^m\) yields the claim.
    \item By the defining equation for \(\px_m\) and \(\py_m\) we have
    \begin{align*}
      \px_{m + k} + δ \py_{m + k} &= ε^{m + k} = (\px_m + δ \py_m) (\px_k + δ \py_k) =\\
                            &= (\px_m \px_k + δ^2 \py_m \py_k) + δ (\px_m \py_k + \px_k \py_m)
    \end{align*}
    and thusly
    \begin{align*}
      \px_{m + k} &= \px_m \px_k + δ^2 \py_m \py_k, \\
      \py_{m + k} &= \px_m \py_k + \px_k \py_m.
    \end{align*}
    The identities for \(\px_{m - k}\) and \(\py_{m - k}\) follow analogously.
  \end{plist}
\end{proof}

Setting \(k = 1\) in the lemma above, one obtains \(\px_{m ± 1} = a \px_m ± δ^2 \py_m\)
and \(\py_{m ± 1} = a \py_m ± \px_m\). A further immediate consequence of this lemma is
the subsequent one, which brings divisibility into play.

\begin{lem}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
  Then for all \(m, k ∈ ℕ\), \(k ≠ 0\) we have
  \begin{thmlist}
    \item \(\py_m\) divides \(\py_{mk}\) in \(\algint\) and
    \item \(\py_{mk} \equiv k \px_m^{k - 1} \py_m \mod \left(\py_m^3\right)\) in
    \(\algint\) i.e. \(\py_{mk} - k \px_m^{k - 1} \py_m\) is contained in the principal
    ideal generated by \(\py_m^3\) in \(\algint\).
  \end{thmlist}
\end{lem}
\begin{proof}
  \begin{plist}
    \item I argue by induction on \(k\). The claim is trivial if \(k = 1\) and
    \cref{lem:addition formulas} implies that
    \[
      \py_{m(k + 1)} = \px_m \py_{mk} + x{mk} \py_m.
    \]

    If the claim is proven for all factors lower than \(k + 1\), one finds that
    \(\py_m \mid \py_{mk}\) and \(\py_m \mid \py_m\) trivially. As a consequence, \(\py_m \mid
    \py_{m(k + 1)}\).

    \item Again the defining equation yields
    \begin{align*}
      \px_{mk} + δ \py_{mk} &= ε^{mk} = {(\px_m + δ \py_m)}^k = \\
                        &= \sum_{j = 0}^k \binom k j \px_m^{k - j} \py_m^j δ^j \\
      \intertext{and}
      \py_{mk} &= \sum_{\substack{j=0\\ j \text{ odd}}}^k
                \binom k j \px_m^{k - j} \py_m^j δ^{j -1}.
    \end{align*}
    In the equation above all terms for \(j > 1\) are divisible by \(\py_m^3\) and
    thus vanish modulo \(\left(\py_m^3\right)\). The only term remaining is \(k
    \px_m^{k - 1} \py_m\) as claimed.
  \end{plist}
\end{proof}

The next lemma even though being easy to prove provides a valuable tool in
studying the sequences \(\px_m\) and \(\py_m\). It derives an recursive definition and
lets one prove properties of the sequences, by proving them for \(m ∈ \lbrace
0, 1 \rbrace\) and inferring the properties for \(m + 1\) from \(m\) and \(m - 1\).

\begin{lem}\label{lem:recursion for x_m and y_m}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
  For \(m > 1\) the following recursive conditions hold.
  \begin{align*}
    \px_{m + 1} &= 2 a \px_m - \px_{m - 1}, & \px_1 = a, \;& \px_0 = 1 \\
    \py_{m + 1} &= 2 a \py_m - \py_{m - 1}, & \py_1 = 1, \;& \py_0 = 0 \\
  \end{align*}
\end{lem}
\begin{proof}
  The initial conditions follow from \(ε = a + δ\) and \(ε^0 = 1\). To prove the
  the difference equations one uses \cref{lem:addition formulas} and obtains
  \begin{align*}
    \px_{m + 1} &= a \px_m + δ^2 \py_m,  &  \py_{m + 1} &= a \py_m + \px_m, \\
    \px_{m - 1} &= a \px_m - δ^2 \py_m,  &  \py_{m + 1} &= a \py_m - \px_m.
  \end{align*}
  Summation yields \(\px_{m + 1} + \px_{m - 1} = 2 a \px_m\) and \(\py_{m + 1} + \py_{m - 1}
  = 2 a \py_m\).
\end{proof}

One applies the previous lemma to prove some congruence conditions.

\begin{lem}
  Let \(K\) be a number field and \(a, b, c ∈ \algint\) such that \(δ(a), δ(b)
  \not\in K\). Then for all \(m ∈ ℕ\) the following congruences hold.
  \begin{plist}
    \item \(\py_m (a) \equiv m \mod (a - 1)\)
    \item If \(a \equiv b \mod (c)\), then \(\px_m (a) \equiv \px_m (b) \mod (c)\) and
    \(\py_m(a) \equiv \py_m(b) \mod (c)\).
  \end{plist}
\end{lem}
\begin{proof}
  The first and second congruence become equalities if \(m = 0\). As for \(m = 1\),
  the first congruence is again an equality as \(\py_1 (a) = 1\) independently of
  \(a\). The second claim is trivial since \(x_1 (η) = η\) and \(\py_1 (η) = 1\) for \(η
  ∈ \lbrace a, b \rbrace\). At this point one proceeds inductively and assumes
  the claims to be proven for all indices lower than \(m + 1\).

  \begin{plist}
    \item Note that \(a \equiv 1 \mod (a - 1)\) and thusly by
    \cref{lem:recursion for x_m and y_m}
    \[
      \py_{m + 1} = 2 a \py_m - \py_{m - 1} \equiv 2 m - (m - 1) = m + 1 \mod (a - 1)
    \]
    as claimed.

    \item Using \cref{lem:recursion for x_m and y_m} we see that for fixed \(m\)
    the coefficients \(\px_m (η)\) and \(\py_m (η)\) can be expressed as some fixed
    polynomial in \(η\). For the congruence this means
    \begin{align*}
      \px_{m + 1} (a) &= 2 a \px_m (a) - \px_{m - 1} (a)
                     \equiv 2 b \px_m (b) - \px_m{m - 1} (b) = \px_{m + 1} (b)
                     \mod (c)
    \end{align*}
    and for \(\py_{m + 1}\) completely analogously.
  \end{plist}
\end{proof}

\begin{lem}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
  Then for \(m, k ∈ ℕ\) such that \(m ± k ≥ 0\) the following congruence holds.
  \[
    \px_{2 m ± k} \equiv - \px_k(a) \mod (\px_m)
  \]
\end{lem}
\begin{proof}
  By applying the addition formulas of \cref{lem:addition formulas} twice and
  using that \(\px_m\) and \(\py_m\) solve Pell's equation~\eqref{eq:Pell} one obtains
  \begin{align*}
    \px_{2m ± k} &= \px_m \px_{m ± k} + δ^2 \py_m \py_{m ± k}
                \equiv δ^2 \py_m (\py_m \px_j ± \px_m \py_j) \\
               &\equiv δ^2 \py_m^2 \px_j = (\px_m^2 - 1) \px_j \\
               &\equiv -\px_j \mod (\px_n).
  \end{align*}
\end{proof}

At this point for the first time in this section I state a result that is no
direct generalisation of a result in~\cite{Davis1973} and present a prove given
in~\cite{Denef1980}. Note however that the result is nevertheless true for the
case \(K = ℚ\) and \(\algint = ℤ\).

\begin{lem}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\).
  Then for all \(η ∈ \algint \setminus \set{0}\) there exists an \(m ∈ ℕ\) such that
  \(η \mid \py_m\) in \(\algint[{L}]\).
  % QUESTION
  \todo{Is \(η \mid y\) in  \(\algint\)?}
\end{lem}
\begin{proof}
  The quotient of the non-trivial, finitely generated \(\algint\)-modules \(\algint[L]\) and \((2 δ η)\)

  Let \(m\) be the order of the group of units in the finite ring
  \(\algint[L]/(2 δ η)\), where \((2 δ η)\) denotes the principal ideal
  generated by \(2 δ η\) in \(\algint[{L}]\). Then \(ε^{±m} \equiv 1 \mod (2 δ
  η)\). Hence, \(2 δ η \mid ε^m - ε^{-m}\) in \(\algint[{L}]\) and therefore
  \[
    \left. η \;\middle\vert\; \frac{ε^m - ε^{-m}}{2 δ} \right.
  \]
  in \(\algint[{L}]\), where the right hand side equals \(\py_m\) by
  \cref{lem:real part of epsilon}.
\end{proof}

\begin{lem}\label{lem:subgroup of ker N L/K}
  Let \(K\) be a number field and \(a ∈ \algint\) such that \(δ = δ(a) \not\in K\). Then the set
  \[
    S = \set{α + δ β \mid (α, β) ∈ \algint^2 \text{ is a solution to~\eqref{eq:Pell} with parameter } d = δ^2}
  \]
  is a subgroup of the kernel of the norm map \(N_{L/K}: U_L → U_K\), where \(U_K\) and \(U_L\) denote the group of units in \(\algint\) and \(\algint[L]\) respectively.
\end{lem}
\begin{proof}
  First of all, note that, if \(α + δ β ∈ S\), so is \(\overline{α + δ β} = α - δ
  β ∈ S\) because
  \[
    α^2 - d {(-β)}^2 = α^2 - d β^2 = 1.
  \]
  Now let \(α + δ β\) be an arbitrary element of \(S\), then
  \[
    N_{L/K}(α + δ β) = (α + δ β) \left(\overline α + δ β \right) = α^2 - d β^2 = 1.
  \]
  This implies that \(α + δ β ∈ \ker N_{L / K}\) but also that \(α + δ β\) is a
  unit, as \(α - δ β\) is its inverse. The product of to arbitrary elements \(α_1 + δ β_1, α_2 + δ β_2 ∈ S\) is
  \[
    (α_1 + δ β_1)(α_2 + δ β_2) = \underbrace{(α_1 α_2 + δ^2 β_1 β_2)}_{∈ \algint} + δ \underbrace{(α_1 β_2 + α_2 β_1)}_{∈ \algint}
  \]
  again of the desired form and as \(\ker N_{L / K}\) is closed under multiplication, \((α_1 + δ β_1)(α_2 + δ β_2)\) is contained in \(S\).
\end{proof}

\begin{lem}\label{lem:rank of N_L/K U_L}
  Let \(L\) and \(K\) be number fields as defined above.
  The image \(N_{L / K}\left(U_L\right) ≤ U_K\) has finite index in \(U_K\).
\end{lem}
\begin{proof}
  I claim that \(N_{L / K}\left(U_L\right)\) contains \(α^2\) for every \(α ∈ U_K\).
  This is because the restriction \(σ_i^K|_{\algint}\) is just the identity on
  \(\algint\) for \(i ∈ \set{1, 2}\) and therefore, \(N_{L / K}(α) = α^2\) for all
  \(α ∈ U_K \subseteq U_L\).

  Let now \(k := \rk K\) and identify \(U_K = ℤ_ℓ \times ℤ^{k}\), where \(ℤ_ℓ =
  μ(K)\) is the finite cyclic group of roots of unity in \(K\)
  (cf.~\cref{thm:Dirichlet}). Consider the following \(k\) elements
  \[
    (\overline 0,1,0,…,0), \; (\overline 0,0,1,0,…,0), \; …, \; (\overline 0, 0, …, 0, 1)
  \]
  contained in \(U_K\). By the claim their ‘squares’ are contained in \(N_{L / K}\left(U_L\right)\) i.e.
  \[
    (\overline 0,2,0,…,0), \; (\overline 0,0,2,0,…,0), \; …, \; (\overline 0, 0, …, 0, 2) ∈ N_{L / K}\left(U_L\right).
  \]
  As a consequence, the direct product
  \[
    G := \set{\overline 0} \times \underbrace{2 ℤ \times … \times 2 Z}_{k\text{-times}}
  \]
  is a subgroup of \(N_{L / K}\left(U_L\right)\) and therefore
  \[
    [U_K : N_{L / K}\left(U_L\right)] ≤ [U : G] ≤ ℓ\, 2^k < ∞.
  \]
\end{proof}

As for the free ranks of \(U_K\), \(U_L\), \(N_{L / K}\left(U_L\right)\) and \(S\) the
lemma above implies that \(\rk N_{L / K}\left(U_L\right) = \rk U_K\) and
therefore, as an immediate consequence of the first isomorphism theorem
\cite[see][II~§1, p.~89]{Lang2002} the following inequality holds
\begin{equation}\label{eq:rank of S}
  \rk S ≤ \rk \ker N_{L / K} = \rk U_L - \rk U_K.
\end{equation}

Before proving the main theorems of this section (\todo{reference them}) I
sketch how \textcite{Davis1973} proceeds in proving that \textsc{H10} is
undecidable over \(ℤ\).

First he proves using the sequences above that the exponential function is
Diophantine~\cite[Thm 3.3]{Davis1973}. Then he is able to extend the language of
Diophantine predicates by \emph{bounded existential} and \emph{bounded universal
quantifiers} i.e.\ by
\begin{align*}
  {(∃y)}_{≤x}ϕ(x, y) &⇔ ∃y\; (y ≤ x ∧ ϕ(x, y)),\\
  {(∀y)}_{≤x}ϕ(x, y) &⇔ ∀y\; (y > x ∨ ϕ(x, y))
\end{align*}
where \(ϕ\) is a positive existential formula~\cite[Thm 5.1]{Davis1973}. The first
one is easily seen to be Diophantine as the order relation on \(ℕ^{*}\) is
Diophantine. Proving the second claim takes the rest of the section. Now using
this result together with the sequence number theorem~\cite[Thm 1.3]{Davis1973}
Davis proofs that a function is Diophantine if and only if it is computable~\cite[Thm 6.1]{Davis1973}.

This already implies the undecidability of \textsc{H10} over \(ℤ\) as Davis
introduced Diophantine pairing functions in~\cite[Thm 1.1]{Davis1973} and
therefore all domains of Diophantine and therefore all computable functions are
Diophantine. But the domains of computable functions are exactly the
semi-decidable subsets of \(ω\) and we have already met a semi-decidable set that
is not decidable, namely the halting set \(\mathcal{K}\). As a consequence, there is a
Diophantine set that is not decidable, or put differently there exists a
polynomial \(p_{\mathcal{K}} ∈ ℤ[X, \seq{Y}]\), such that for every Turing machine \(\mathbb
A\), that can decide some polynomial identities, there exists an \(α ∈ ℤ\) such
that \(\mathbb A\) cannot correctly decide
\[
  ∃\seq{β}: p_{\mathcal{K}}(α, \seq{β}) = 0.
\]

\subsection{Hilbert's tenth problem over totally real number fields}
% QUESTION
\todo{Do I need to cite Denef1980 again?}

For the remainder of this section let \(K\) be a totally real number field of
degree \(n > 1\) over the rationals \(ℚ\), and let \(\seq{σ}\) denote the embeddings
of \(K\) into the reals \(ℝ\). Assume \(a ∈ \algint\) satisfies \(δ = δ(a) \not\in
\algint\) as above and additionally
\begin{equation} \label{eq:embeddings of a into reals v1}
  σ_1(a) ≥ 2^{2n}, \quad |σ_i(a)| ≤ \frac 12, \quad \text{for } 2 ≤ i ≤ n.
\end{equation}
% QUESTION
\todo{Does this imply that delta is not in O K?}

Then note firstly that \(a\) cannot be a rational integer as they are preserved
point-wise by each embedding \(σ_i\) for \(1 ≤ i ≤ n\). As the
extension \(L/K\) is quadratic, every \(σ_i\) can be extended to exactly two
embeddings \(σ_{i1}\) and \(σ_{i2}\) of \(L\) into the complex plane \(ℂ\) by
‘composing’ with \(σ_1^K\) or \(σ_2^K\). This yields
\[
  σ_{i1}(α + δβ) = σ_i(α) + \sqrt{{σ_i(a)}^2 - 1} σ_i(β) \quad \text{and} \quad
  σ_{i1}(α + δβ) = σ_i(α) - \sqrt{{σ_i(a)}^2 - 1} σ_i(β)
\]
for all \(α, β ∈ \algint\). As \(|σ_i(a)| ≤ 1/2\) for \(2 ≤ i ≤ n\) the radicands
in the equation above are both negative and as a consequence all \(σ_{i1},
σ_{i2}\) are conjugate pairs of non-real embeddings of \(L\). Only \(σ_{11}\) and
\(σ_{12}\) embed \(L\) into the reals \(ℝ\). I will identify \(L\) with the image of its
embedding \(σ_{11}(L) \subseteq ℝ\) and write \(η\) instead of \(σ_{11}(η)\) for all
\(η ∈ L\).

\begin{lem}
  Suppose \(K\) is a totally real number field and \(a ∈ \algint\) satisfies \(δ =
  δ(a) \not\in \algint\) as well as~\eqref{eq:embeddings of a into reals v1}.
  Then for all positive integers \(m\), and all pairs \((i, j) ∈ \set{2, …, n}
  \times \set{1, 2}\) the following inequalities hold
  \begin{thmlist}
    \item \(a / 2 < δ < a\);
    \item \(\Re (σ_{ij}(δ))= 0\), i.e.\ the image of \(δ\) is imaginary, and \(1 / 2 < | σ_{ij}(δ) | < 1\);
    \item \(a < ε < 2a\) and \(| σ_{ij}(ε) | = 1\);
    \item \(ε^m / (4a) < \py_m < ε^m / a\) and \(|σ_i(\py_m)| < 2\);
    \item \(ε^m / 2 < \px_m < ε^m\) and \(|σ_i(\px_m)| < 1\).
  \end{thmlist}
\end{lem}
\begin{proof}
  As \(a ∈ \algint\) the images \(σ_{11}(a) = a\) and \(σ_1(a)\) coincide. Therefore, \(a ≥ 2^{2n}\) by~\eqref{eq:embeddings of a into reals v1}.
  \begin{plist}
    \item We have
      \[
        \frac{a^2}{4} = a^2 - \frac{3a^2}{4} ≤ a^2 - \frac{3}{4} 2^{4n} < a^2 - 1 < a^2
      \]
      As \(a > 0\) and \(δ = \sqrt{a^2 - 1} ≥ 0\) one can take square roots in the inequality above and obtain the claim.
    \item As was mentioned above, by~\eqref{eq:embeddings of a into reals v1}
      the radicand in \(σ_i(δ) = \sqrt{{σ_i(a)}^2 - 1}\) is negative yielding the
      first claim. To approximate the absolute value of \(σ_i(δ)\), one notes
      \[
        |σ_i(δ)|^2 = {\Im(σ_i(δ))}^2 = 1 - {σ_i(a)}^2 ≥ 1 - \frac{1}{4} ≥ \frac{1}{4}
      \]
      and, since \({σ_i(a)}^2 ≥ 0\),
      \[
        |σ_i(δ)|^2 ≤ 1
      \]
      as well. Again taking square roots yields the claim.
    \item By (i) \(0 < δ < a\) and therefore
      \[
        a < a + δ = ε < 2a.
      \]
      The other claim follows from
      \[
        |σ_{ij}(ε)|^2 = σ_{ij}(ε) \; \overline{σ_{ij}(ε)} =
        \left(σ_i(a) + σ_{i1}(δ)\right) \; \left(σ_i(a) - σ_{i1}(δ)\right) =
        {σ_i(a)}^2 - ({σ_i(a)}^2 - 1) = 1,
      \]
      where the second identity is a consequence of (ii).
    \item This should follow from \cref{lem:real part of epsilon}.
      % TODO
      \todo{write me}
    \item This should follow from \cref{lem:real part of epsilon}.
      % TODO
      \todo{write me}
  \end{plist}
\end{proof}

As a next step, we want to show that we have already found all solutions of
Pell's equation~\eqref{eq:Pell}. For this we need some lemmas.

Recall the group \(S ≤ \ker N_{L / K}\) defined in \cref{lem:subgroup of ker N
L/K}. We have seen in \cref{lem:rank of N_L/K U_L} and the subsequent
inequality~\eqref{eq:rank of S} that the free rank of \(S\) can be bound from
above. Note that \(ε\) is contained in \(S\). Therefore, the following lemma implies
that \(\rk S\) can be bound from below by \(1\).

\begin{lem}\label{lem:rank of S is greater 0}
  Let \(K\) be a totally real number field and \(a ∈ \algint\) satisfies \(δ =
  δ(a) \not\in \algint\) as well as~\eqref{eq:embeddings of a into reals v1}.
  Then \(ε(a) = ε\) is torsion free i.e.\ there is a group isomorphism \(⟨ε⟩ \cong
  ℤ\).
\end{lem}
\begin{proof}
  Assume otherwise that \(ε^m = 1\) for some positive integer \(m\) i.e. \(ε\) is an
  \(m\)-th root of unity. As we have identified \(L\) with a subset of \(ℝ\), this
  leaves \(±1\) as values for \(ε = 1 + δ\). This is impossible as \(δ \not\in
  \algint\).
\end{proof}

As a consequence, of \cref{thm:Dirichlet} we find that
\[
  1 ≤ \rk S ≤ \rk U_L - \rk U_K ≤ (n + 1) - n = 1.
\]
In other words, we can write every \(η\) in \(S\) as a product \(ζ ε_0^k\), where \(ζ ∈ U_L\) is a root of unity and \(ε_0\)
