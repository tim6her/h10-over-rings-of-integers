% !TEX encoding = UTF-8
% !TEX TS-program = xelatex
% !TEX spellcheck = en_GB
% !TEX engine = xelatex
% !TEX root = ../Herbstrith-H10_over_AI.tex
%
% ███████ ████████ ██████  ██    ██  ██████ ████████     ██████  ███████ ███████
% ██         ██    ██   ██ ██    ██ ██         ██        ██   ██ ██      ██
% ███████    ██    ██████  ██    ██ ██         ██        ██████  █████   ███████
%      ██    ██    ██   ██ ██    ██ ██         ██        ██   ██ ██           ██
% ███████    ██    ██   ██  ██████   ██████    ██ ██     ██   ██ ███████ ███████

Before tackling Hilbert's tenth problem over selected rings of algebraic
integers, I list some structural results and methods used within the subsequent
proofs. For further structural results see the study~\cite{Shlapentokh2000}.

\begin{lem}\label{lem:moving up}
Let \(R_1 \subseteq R_2\) be integral domains such that the quotient field of
\(R_2\) is not algebraically closed. If \(S ⊂ R_1^m\) is Diophantine over
\(R_1\) and \(R_1\) has a Diophantine definition over \(R_2\), then \(S\) is
Diophantine over \(R_2\). If \(R_2\) is computable, then the defining equation
of \(S\) over \(R_2\) can be obtained efficiently from the equation over
\(R_1\).
\end{lem}
\begin{proof}
  Let \(f(X, Y_1, …, Y_n)\) give rise to a Diophantine definition of \(R_1\)
  over \(R_2\) and let \(S \subseteq R_1^m\) be Diophantine over \(R_1\). Then
  there exists some polynomial
  \[
    p ∈ R_1[X_1, …, X_m, Y_1, …, Y_ℓ]
  \]
  witnessing that \(S\) is Diophantine. To make notation clearer, I assume \(ℓ =
  m = n = 1\). The general case follows completely analogously. Then
  \[
    S = \left\lbrace  α ∈ R_2 :
         ∃β, γ_1, γ_2 ∈ R_2 \text{ with }
            p(α, β) = 0 ∧ f(α, γ_1) = 0 ∧ f(β, γ_2) = 0\right\rbrace
  \]
  is a Diophantine definition of \(S\) over \(R_2\).
\end{proof}

\textcite{Shlapentokh2000} notes that the previous lemma and its corollary are
\enquote{the only tool\textins{s} successfully used to show the undecidability
of \textsc{H10} for various subrings of the number fields}. They explain the
usefulness of Diophantine definitions.

\begin{cor}\label{cor:Diophantine theory is undecidable}
  Let \(R \supseteq ℤ\) be a computable integral domain, whose quotient field is
  not algebraically closed. If \(ℤ\) has a Diophantine definition over \(R\)
  then the Diophantine theory \(\mathtt{H10}(\struc{R})\) of the rings-structure
  \(\struc{R}\) of \(R\) is undecidable.
\end{cor}
\begin{proof}
  Since the non-negative integers are Diophantine over \(ℤ\) and \(ℤ\) is
  Diophantine over \(R\), we know by the lemma that \(ℕ\) is Diophantine over
  \(R\) and thus \(ℕ ⊂ R\) is semi-decidable. However, the complement \(ℤ
  \setminus ℕ\) is Diophantine over \(ℤ\) as well, and thus \(ℕ ⊂ R\) is
  decidable.

  As in the proof of \cref{cor:H10 over Z}, we can embed the halting set
  \(\mathcal{K} ⊂ ω\) by a computable bijection \(f: ω → ℕ ⊂ R\). Again,
  \(f(\mathcal{K})\) is semi-decidable and thus Diophantine over the rational
  integers \(ℤ\). By the lemma \(f(\mathcal{K})\) is Diophantine over \(R\).
  Thus, there exists a polynomial \(p_{\mathcal{K}} ∈ R[X, \seq[m]{Y}]\) such
  that
  \begin{equation}\label{eq:halting set is Diophantine}
    x ∈ \mathcal{K} \quad ⇔ \quad
    ∃ \seq[m]{y} ∈ R : p_{\mathcal{K}}(f(x), \seq[m]{y}) = 0,
  \end{equation}
  and as before the computable function mapping \(x ∈ ω\) to the Gödelization of
  the equation above witnesses many-one reducibility of \(\mathcal{K}\) to
  \(\mathtt{H10}(\struc{R})\).
\end{proof}

Note that this corollary applies to \(\algint\) for each algebraic number field
\(K\) since the quotient field of \(\algint\) is (isomorphic to) \(K\). In fact,
in the case of algebraic integers one can prove that if \(ℤ\) is Diophantine
over \(\algint\), then the purely Diophantine theory of \(\algint\) is equally
hard to decide as the Diophantine theory and the halting set.

\begin{cor}
  Let \(K\) be a number field such that the rational integers \(ℤ\) are
  Diophantine over its ring of algebraic integers \(\algint\). Then the halting
  set \(\mathcal{K}\) is many-one reducible to the purely Diophantine theory
  \(\mathtt{H10}^*(\struc{O}_K)\) of \(\algint\).
\end{cor}
\begin{proof}
  As in the proof of \cref{cor:Diophantine theory is undecidable} one finds a
  computable bijection \(f: ω → ℕ ⊂ \algint\) and considers \(f(\mathcal{K})\).
  Since \(ℤ\) is fixed point-wise by all automorphisms of \(K\), in particular
  \(f(\mathcal{K})\) is fixed point-wise, and by \cref{thm:purely Diophantine
  sets} the set \(f(\mathcal{K})\) is in fact purely Diophantine.

  This means that the polynomial \(p_{\mathcal{K}}\) in \eqref{eq:halting set is
  Diophantine} can be chosen to have rational integral coefficients. Now
  since \(f(\mathcal{K})\) is a subset of \(ℕ\), we deduce that the partially
  evaluated polynomial
  \[
    p_{\mathcal{K}}(f(x), \seq[m]{Y})
  \]
  still has rational integral coefficents. It follows that the Gödelization of
  \eqref{eq:halting set is Diophantine} is contained in the theory
  \(\mathtt{H10}^*(\struc{O}_K)\) if and only if \(x ∈ \mathcal{K}\), which
  concludes the proof.
\end{proof}

One can even strengthen the result of the corollary to obtain the full analogue
of the \textsc{DPRM}-theorem~(\ref{thm:DPRM}) for rings of algebraic integers.
This was shown by \textcite[§11]{Davis1976}.

\begin{thm}\label{thm:CE sets are Diophantine}
  Let \(K\) be an algebraic number field and \(\algint\) its ring of
  algebraic integers. Then every semi-decidable subset of \(\algint\) is
  Diophantine if and only if the rational integers \(ℤ\) are Diophantine over
  \(\algint\).
\end{thm}
\begin{proof}
  As the \(\lang_{\algint}\)-structure of \(\algint\) is computable, the
  interpretations of the constants \(\mathtt{-1, 0, 1}\) and addition are
  computable. As a consequence, the surjective function \(f: ω → ℤ \subseteq
  \algint\) defined by
  \[
    f(\enc{n}) = \Bigg\lbrace\begin{array}{l l}
             0 \overbrace{+ 1 … + 1}^{k\text{-times}} & \text{if } n = 2k\\
             0 \underbrace{+ (-1) … + (-1)}_{k\text{-times}} &
                \text{if } n = 2k + 1
           \end{array}
  \]
  is computable and \(ℤ\) is semi-decidable. Thus, it suffices to prove that if
  \(ℤ\) is Diophantine over \(\algint\), then every semi-decidable set is
  Diophantine over \(\algint\).

  Let \(A \subseteq \algint^k\) be semi-decidable and let \(\set{ξ_1, …, ξ_n}\)
  be an integral basis for \(\algint\) over \(ℤ\). We define the set of all
  coefficients of elements in \(A\) by
  \[
    S := \set{(a_{11}, …, a_{1n}, …, a_{k1}, …, a_{kn}) ∈ ℤ^{kn} :
              \left(\sum_{i=1}^n a_{ij} ξ_i\right)_{1 ≤ j ≤ k} ∈ A}.
  \]
  As \(A\) is semi-decidable so is \(S\). Note that this is exactly how we
  efficiently represented finitely generated free \(ℤ\)-algebras and thus
  \(\algint\) in \cref{ex:Z is computable}. By the
  \textsc{DPRM}-theorem~(\ref{thm:DPRM}) the set \(S\) is Diophantine over
  \(ℤ\), i.e.\ there exists a polynomial \(p\) with coefficients in \(ℤ\) such
  that
  \begin{align*}
    &(a_{11}, …, a_{1n}, …, a_{k1}, …, a_{kn}) ∈ R ⇔\\
    &\quad ∃ \seq[m]{β} ∈ ℤ: p(a_{11}, …, a_{1n}, …, a_{k1}, …, a_{kn},
     \seq[m]{β}) = 0.
  \end{align*}
  It immediately follows that
  \begin{align*}
    &(\seq[k]{α}) ∈ A ⇔\\
    & \quad ∃ a_{11}, …, a_{1n}, …, a_{k1}, …, a_{kn},\,
      \seq[m]{β} ∈ ℤ :\\
    & \quad \begin{cases}
              p(a_{11}, …, a_{1n}, …, a_{k1}, …, a_{kn}, \seq[m]{y}) = 0\\
              α_1 = a_{11} ξ_1 + … + a_{1n} ξ_n\\
              \vdots\\
              α_k = a_{k1} ξ_1 + … + a_{kn} ξ_n
            \end{cases}
  \end{align*}
  By assumption there exists a Diophantine definition of \(ℤ\) over \(\algint\).
  So by the procedure described in the proof of \cref{cor:Diophantine theory is
  undecidable}, one can translate the above conditions into a Diophantine
  definition of \(A\) over \(\algint\).
\end{proof}

Given the tools and structural results that we have just introduced, all that is
left to prove the undecidability of Hilbert's tenth problem over a fixed ring of
algebraic integers \(\algint\), is proving that \(ℤ\) has a Diophantine
definition over \(\algint\). This task will fill the remainder of this thesis.
But before moving on to the case of specific number fields I will present an
important tool in proving that a field extension \(L/K\) has a Diophantine
definition of \(\algint\) over \(\algint[L]\). This so called \emph{strong
vertical method} was formalized by Denef and Lipshitz and successfully applied
over various number fields
\cite[e.g.][]{Denef1975,Denef1978,Denef1980,Pheidas1988,Shlapentokh1989}.
I do however present a version of this result that can be obtained from Lem.~1
of \cite{Denef1978} and Lem.~8 of \cite{Denef1980} and is similar to Lem.~7.1.3
of \cite{Shlapentokh2007}.

\begin{thm}\label{thm:strong vertical method}
  Let \(L/K\) be an extension of number fields and \(n = [L : ℚ]\). If \(x, y ∈
  \algint[L]\) and \(α ∈ \algint\) satisfy
  \begin{align}
    \label{eq:sigma x and norm of y}
    & |σ_i(x)| < \frac{1}{2} |N_{L/ℚ}(y)|^{\frac{1}{n}}
      \text{ for all } 1 ≤ i ≤ n, \\
    \label{eq:sigma alpha and norm of y}
    & |σ_i(α)| < \frac{1}{2} |N_{L/ℚ}(y)|^{\frac{1}{n}}
      \text{ for all } 1 ≤ i ≤ n, \text{ and}\\
    \label{eq:x mod alpha}& x \equiv α \mod (y) \text{ in } \algint[L],
  \end{align}
  where \(\seq{σ}\) denote the embeddings of \(L\) into the complex pane
  \(ℂ\). Then
  \[
    x = α ∈ \algint.
  \]
\end{thm}
\begin{proof}
  If \(y = 0\), one interprets \eqref{eq:x mod alpha} as \(x = α\) and is
  done. Hence, we may assume that \(y\) is non-zero. By \eqref{eq:x mod alpha}
  we know that there exists an integer \(β ∈ \algint[L]\) such that
  \(x - α = β \, 2 y^{2cn}\). As a consequence, either \(x = α\) or
  \[
    |N_{L/ℚ}(x - α)| = |N_{L/ℚ}(β \, 2 y^{2cn})| ≥ |N_{L/ℚ}(y)|
  \]
  holds. However, \eqref{eq:sigma x and norm of y} and \eqref{eq:sigma alpha and
  norm of y} imply that
  \[
    |N_{L/ℚ}(x - α)| = \prod_{i=1}^n |σ_i(x - α)| ≤
    \prod_{i=1}^n 2 \max(|σ_i(x)|, |σ_i(α)|) < |N_{L/ℚ}(y)|.
  \]
\end{proof}

Unlike Shlapentokh's formulation if \(y ∈ \algint\) then the conditions on the
embeddings are easily seen to be Diophantine \cite[cf.][Lem.~8]{Denef1980}.

\begin{lem}\label{lem:8}
  Let \(K\) be a number field of degree \(n\) over \(ℚ\) and let \(\seq{σ}\) be
  its embeddings into the complex pane. Let \(α, β ∈ \algint\) be algebraic
  integers with \(β ≠ 0\) such that
  \[
    2^{n + 1} \prod_{i = 0}^{n - 1} (α + i)^n \mid β.
  \]
  Then \(|σ_i(α)| < 1/2 |N_{K/ℚ}(β)|^{1/n}\) for all \(1 ≤ i ≤ n\).
\end{lem}
\begin{proof}
  Fix some \(j ∈ \set{0, 1, …, n - 1}\) and notice that \(2^{n + 1} (α + j)^n\)
  divides \(β\). From this it follows that
  \[
    |N_{K/ℚ}(2^{n + 1} (α + j)^n)| ≤ |N_{K/ℚ}(β)|,
  \]
  or put differently
  \[
    1 ≤ |N_{K/ℚ}(α + j)| ≤ |N_{K/ℚ}(2^{-n - 1} β)|^{\frac{1}{n}}.
  \]
  Set \(c := |N_{K/ℚ}(2^{-n - 1} β)|^{1/n}\) then
  \[
    |N_{K/ℚ}(α + j)| = \prod_{i = 1}^n |σ_i(α) + j| ≤ c.
  \]
  I claim that this implies that \(|σ_i(a)| < 2^n c = 1/2 |N_{K/ℚ}(β)|^{1/n}\).

  Indeed, this follows from a more general property of complex numbers. Namely,
  if \(\seq{a} ∈ ℂ\) are fixed complex numbers with the property that
  \[
    \prod_{i = 1}^n |a_i + j| ≤ C
  \]
  for a fixed constant \(C ≥ 1\) and all \(0 ≤ j ≤ n - 1\) then \(|a_i| < 2^n
  C\) for all \(1 ≤ i ≤ n\).

  Note that if \(0 ≤ j_1, j_2 ≤ n - 1\) have the property that \(|a_i + j_k| <
  \frac{1}{2}\) then
  \[
    |j_1 - j_2| ≤ |a_i + j_1| + |a_i + j_2| < \frac{1}{2} + \frac{1}{2} = 1
  \]
  and thus $j_1 = j_2$.

  We will argue by induction on $n$ and notice that the claim is trivial for $n
  = 1$. Thus, we may assume that $n > 1$ and that the claim is proven for all
  smaller collections of complex numbers. We will distinguish two cases.

  Let us first assume that
  \[
    ∀ j ∈ \set{0, …, n - 1} : ∃ i_j ∈ \set{1, …, n}:
      |a_{i_j} + j| < \frac{1}{2}.
  \]
  Since we allow only \(n\) values for both \(j\) and \(i_j\) and we know by the
  observation that two different values of \(j\) must have two different
  witnesses \(i_j\), we find that there must exist a bijective function  \(f:
  \{0, …, n- 1\} → \{1, …, n\}\) with the property that
  \[
    |a_{f(j)} + j| < \frac{1}{2}.
  \]
  Then for all indices \(j' ≠ j\) we must have
  \[
    |a_{f(j)} + j'| ≥ \frac{1}{2}.
  \]
  Set \(i_0 := f(n - 1)\) then we know for all \(0 ≤ j ≤ n - 2\) that
  \(|a_{i_0} + j| ≥ 1/2\) and therefore that
  \[
    C ≥ \prod_{i = 1}^n |a_i + j| ≥
        \frac{1}{2} \prod_{\substack{i = 1\\i ≠ i_0}}^n |a_i + j|
  \]
  Thus, \(a_1, …, a_{i_0 - 1}, a_{i_0 + 1}, …, a_n\) satisfy the assumption of
  the induction hypothesis (w.r.t.\ \(c' := 2c\)) and hence
  \[
    |a_i| < 2^{n - 1} 2 C.
  \]
  To reach a contradiction assume that \(|a_{i_0}| ≥ 2^n C\). But then
  \[
    \frac{1}{2} > |a_{i_0} + {n - 1}| ≥
                  |a_{i_0}| - |n - 1| ≥ 2^n c - n + 1 ≥ 2^n - n + 1 ≥ 2
  \]
  holds, thus, concluding the first case.

  As for the second case, let us assume that
  \[
    ∃ j_0 ∈ \set{0, …, n - 1} : ∀ i \set{1, …, n}: |a_i + j_0| ≥ \frac{1}{2}.
  \]
  Then, we have for all \(i ≤ k ≤ n\) that
  \[
    2^nC ≥ \prod_{i= 1}^n \underbrace{2|a_i + j_0|}_{≥ 1} ≥ 2|a_k + j_0|.
  \]
  Now if we can choose \(j_0 = 0\), we are done. Otherwise, there exists an
  index \(i_0\) such that \(|a_{i_0}| < 1/2\). But then \(|a_{i_0} + j| > 1/2\)
  for all \(1 ≤ j ≤ n - 1\). Now we have that
  \[
    C ≥ \prod_{i = 1}^n |a_i + j| ≥
        \frac{1}{2} \prod_{\substack{i = 1\\i ≠ i_0}}^n |a_i + j|
  \]
  is satisfied for all \(1 ≤ j ≤ n - 1\). Set \(b_i := a_i + 1\) for all \(i ≠
  i_0\). Then we can use the induction hypothesis on the \(b_i\) to obtain that
  \[
    |a_i + 1| = |b_i| < 2^n c.
  \]
  Hence, \(|a_i| < 2^n c + 1\) which is a bit weaker than the claimed result.

  % TODO How do I get rid of the trailing +1?
  \todo{How do I get rid of the trailing \(+1\)?}
\end{proof}

If \(σ_i\) is a real embedding, the following lemma
\cite[cf.][Lem.~9]{Denef1980} could have been used as well.

\begin{lem}\label{lem:approximations of embeddings are Diophantine}
  Let \(K\) be a number field and \(σ: K → ℝ\) be a real embedding. Then the
  relation \(σ(α) ≥ 0\) is Diophantine over \(\algint\).
\end{lem}
\begin{proof}
  By the strong approximation theorem~(\ref{thm:strong approximation}) we can
  find an algebraic integer \(c\) such that \(σ(c) > 0\) and \(τ(c) < 0\) for
  all other real embeddings.
  % TODO: Why an algebraic integer?
  \todo{Why an algebraic integer?}
  Let \(α ∈ \algint\) be such that \(σ(α) ≥ 0\). Then by\cref{lem:quadratic
  form} there exist \(z_1, z_2, z_3, z_4 ∈ K\) such that
  \[
    x = z_1^2 + z_2^2 + c z_3^2 + z_4^2
  \]
  Since \(K\) is the fraction field of \(\algint\), there exists an algebraic
  integer \(y_0\) such that \(y_0 z_i\) is an algebraic integer for \(1 ≤ i ≤
  4\). We conclude that
  \[
    ∃ y_0, y_1, y_2, y_3, y_4 ∈ \algint : \left(y_0 ≠ 0 ∧
      y_0^2 x = y_1^2 + y_2^2 + c y_3^2 + y_4^2\right)
  \]
  is a Diophantine representation of a set containing \(x\). To finish the proof
  note that if \(x\) satisfies the representation above then
  \[
    σ(x) = σ\left(\frac{y_1}{y_0}\right)^2 +
           σ\left(\frac{y_2}{y_0}\right)^2 +
           c σ\left(\frac{y_3}{y_0}\right)^2 +
           σ\left(\frac{y_4}{y_0}\right)^2 ≥ 0.
  \]
\end{proof}

Note that we can exchange the bound \(0\) to any value in the image \(σ(K) ⊂
ℝ\). Indeed, for a given bound \(σ(a/b)\), where \(a, b ∈ \algint\)
(cf.~\cref{thm:K is the quotient field of O K}), this can be achieved by the
relation
\[
  ∃ β ∈ \algint : (σ(β) ≥ 0) ∧ \left(β = α - \frac{a}{b}\right)
\]
which is equivalent to the Diophantine relation
\[
  ∃ β ∈ \algint : (σ(β) ≥ 0) ∧ (bβ = bα - a).
\]
Similarly, one can obtain upper bounds by replacing \(x\) by \(-x\).
